var Li=Object.create;var $e=Object.defineProperty;var ji=Object.getOwnPropertyDescriptor;var Ii=Object.getOwnPropertyNames;var Mi=Object.getPrototypeOf,Ai=Object.prototype.hasOwnProperty;var ur=r=>$e(r,"__esModule",{value:!0});var u=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),Oi=(r,e)=>{for(var t in e)$e(r,t,{get:e[t],enumerable:!0})},cr=(r,e,t,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Ii(e))!Ai.call(r,i)&&(t||i!=="default")&&$e(r,i,{get:()=>e[i],enumerable:!(s=ji(e,i))||s.enumerable});return r},xi=(r,e)=>cr(ur($e(r!=null?Li(Mi(r)):{},"default",!e&&r&&r.__esModule?{get:()=>r.default,enumerable:!0}:{value:r,enumerable:!0})),r),Fi=(r=>(e,t)=>r&&r.get(e)||(t=cr(ur({}),e,1),r&&r.set(e,t),t))(typeof WeakMap!="undefined"?new WeakMap:0);var U=u(S=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0});S.API_V1_1_STREAM_PREFIX=S.API_V1_1_UPLOAD_PREFIX=S.API_V1_1_PREFIX=S.API_V2_LABS_PREFIX=S.API_V2_PREFIX=void 0;S.API_V2_PREFIX="https://api.twitter.com/2/";S.API_V2_LABS_PREFIX="https://api.twitter.com/labs/2/";S.API_V1_1_PREFIX="https://api.twitter.com/1.1/";S.API_V1_1_UPLOAD_PREFIX="https://upload.twitter.com/1.1/";S.API_V1_1_STREAM_PREFIX="https://stream.twitter.com/1.1/"});var G=u(J=>{"use strict";Object.defineProperty(J,"__esModule",{value:!0});J.PreviousableTwitterPaginator=J.TwitterPaginator=void 0;var Ce=class{constructor({realData:e,rateLimit:t,instance:s,queryParams:i,sharedParams:n}){this._maxResultsWhenFetchLast=100,this._realData=e,this._rateLimit=t,this._instance=s,this._queryParams=i,this._sharedParams=n}get _isRateLimitOk(){return this._rateLimit.reset*1e3<Date.now()?!0:this._rateLimit.remaining>0}makeRequest(e){return this._instance.get(this.getEndpoint(),e,{fullResponse:!0,params:this._sharedParams})}makeNewInstanceFromResult(e,t){return new this.constructor({realData:e.data,rateLimit:e.rateLimit,instance:this._instance,queryParams:t,sharedParams:this._sharedParams})}getEndpoint(){return this._endpoint}injectQueryParams(e){return{...e?{max_results:e}:{},...this._queryParams}}async next(e){let t=this.getNextQueryParams(e),s=await this.makeRequest(t);return this.makeNewInstanceFromResult(s,t)}async fetchNext(e){let t=this.getNextQueryParams(e),s=await this.makeRequest(t);return await this.refreshInstanceFromResult(s,!0),this}async fetchLast(e=1/0){let t=this.getNextQueryParams(this._maxResultsWhenFetchLast),s=0;for(;s<e&&this._isRateLimitOk;){let i=await this.makeRequest(t);if(await this.refreshInstanceFromResult(i,!0),s+=this.getPageLengthFromRequest(i),this.isFetchLastOver(i))break;t=this.getNextQueryParams(this._maxResultsWhenFetchLast)}return this}get rateLimit(){return{...this._rateLimit}}get data(){return this._realData}*[Symbol.iterator](){yield*this.getItemArray()}async*[Symbol.asyncIterator](){yield*this.getItemArray();let e=this;for(;this._isRateLimitOk&&e.getItemArray().length>0;){let t=await e.next(this._maxResultsWhenFetchLast);this._rateLimit=t._rateLimit,yield*t.getItemArray(),e=t}}};J.TwitterPaginator=Ce;var dr=class extends Ce{async previous(e){let t=this.getPreviousQueryParams(e),s=await this.makeRequest(t);return this.makeNewInstanceFromResult(s,t)}async fetchPrevious(e){let t=this.getPreviousQueryParams(e),s=await this.makeRequest(t);return await this.refreshInstanceFromResult(s,!1),this}};J.PreviousableTwitterPaginator=dr;J.default=Ce});var ve=u(ne=>{"use strict";var ki=ne&&ne.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(ne,"__esModule",{value:!0});ne.CursoredV1Paginator=void 0;var Bi=ki(G()),hr=class extends Bi.default{getNextQueryParams(e){var t;return{...this._queryParams,cursor:(t=this._realData.next_cursor_str)!==null&&t!==void 0?t:this._realData.next_cursor,...e?{count:e}:{}}}isFetchLastOver(e){return this.isNextCursorInvalid(e.data.next_cursor)&&this.isNextCursorInvalid(e.data.next_cursor_str)}isNextCursorInvalid(e){return e===void 0||e===0||e===-1||e==="0"||e==="-1"}};ne.CursoredV1Paginator=hr});var dt=u(ae=>{"use strict";Object.defineProperty(ae,"__esModule",{value:!0});ae.WelcomeDmV1Paginator=ae.DmEventsV1Paginator=void 0;var mr=ve(),fr=class extends mr.CursoredV1Paginator{constructor(){super(...arguments);this._endpoint="direct_messages/events/list.json"}refreshInstanceFromResult(e,t){let s=e.data;this._rateLimit=e.rateLimit,t&&(this._realData.events.push(...s.events),this._realData.next_cursor=s.next_cursor)}getPageLengthFromRequest(e){return e.data.events.length}getItemArray(){return this.events}get events(){return this._realData.events}};ae.DmEventsV1Paginator=fr;var _r=class extends mr.CursoredV1Paginator{constructor(){super(...arguments);this._endpoint="direct_messages/welcome_messages/list.json"}refreshInstanceFromResult(e,t){let s=e.data;this._rateLimit=e.rateLimit,t&&(this._realData.welcome_messages.push(...s.welcome_messages),this._realData.next_cursor=s.next_cursor)}getPageLengthFromRequest(e){return e.data.welcome_messages.length}getItemArray(){return this.welcomeMessages}get welcomeMessages(){return this._realData.welcome_messages}};ae.WelcomeDmV1Paginator=_r});var gr=u(pr=>{"use strict";Object.defineProperty(pr,"__esModule",{value:!0})});var yr=u(wr=>{"use strict";Object.defineProperty(wr,"__esModule",{value:!0})});var Pr=u(vr=>{"use strict";Object.defineProperty(vr,"__esModule",{value:!0})});var br=u(Tr=>{"use strict";Object.defineProperty(Tr,"__esModule",{value:!0})});var Sr=u(Rr=>{"use strict";Object.defineProperty(Rr,"__esModule",{value:!0})});var qr=u(Dr=>{"use strict";Object.defineProperty(Dr,"__esModule",{value:!0})});var jr=u(Lr=>{"use strict";Object.defineProperty(Lr,"__esModule",{value:!0})});var Ir=u(Pe=>{"use strict";Object.defineProperty(Pe,"__esModule",{value:!0});Pe.EDirectMessageEventTypeV1=void 0;var Ni;(function(r){r.Create="message_create",r.WelcomeCreate="welcome_message"})(Ni=Pe.EDirectMessageEventTypeV1||(Pe.EDirectMessageEventTypeV1={}))});var Ar=u(Mr=>{"use strict";Object.defineProperty(Mr,"__esModule",{value:!0})});var Or=u(w=>{"use strict";var Vi=w&&w.__createBinding||(Object.create?function(r,e,t,s){s===void 0&&(s=t),Object.defineProperty(r,s,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,s){s===void 0&&(s=t),r[s]=e[t]}),E=w&&w.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Vi(e,r,t)};Object.defineProperty(w,"__esModule",{value:!0});E(gr(),w);E(yr(),w);E(Pr(),w);E(br(),w);E(Sr(),w);E(qr(),w);E(jr(),w);E(Ir(),w);E(Ar(),w)});var Fr=u(xr=>{"use strict";Object.defineProperty(xr,"__esModule",{value:!0})});var kr=u(Ur=>{"use strict";Object.defineProperty(Ur,"__esModule",{value:!0})});var Nr=u(Br=>{"use strict";Object.defineProperty(Br,"__esModule",{value:!0})});var Wr=u(Vr=>{"use strict";Object.defineProperty(Vr,"__esModule",{value:!0})});var $r=u(Er=>{"use strict";Object.defineProperty(Er,"__esModule",{value:!0})});var Hr=u(Cr=>{"use strict";Object.defineProperty(Cr,"__esModule",{value:!0})});var Kr=u(D=>{"use strict";var Wi=D&&D.__createBinding||(Object.create?function(r,e,t,s){s===void 0&&(s=t),Object.defineProperty(r,s,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,s){s===void 0&&(s=t),r[s]=e[t]}),oe=D&&D.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Wi(e,r,t)};Object.defineProperty(D,"__esModule",{value:!0});oe(Fr(),D);oe(kr(),D);oe(Nr(),D);oe(Wr(),D);oe($r(),D);oe(Hr(),D)});var Xr=u(y=>{"use strict";Object.defineProperty(y,"__esModule",{value:!0});y.EApiV2ErrorCode=y.EApiV1ErrorCode=y.ApiResponseError=y.ApiRequestError=y.ETwitterApiError=void 0;var ht;(function(r){r.Request="request",r.Response="response"})(ht=y.ETwitterApiError||(y.ETwitterApiError={}));var mt=class extends Error{constructor(){super(...arguments);this.error=!0}},Qr=class extends mt{constructor(e,t){super(e);this.type=ht.Request,Error.captureStackTrace(this,this.constructor),Object.defineProperty(this,"_options",{value:t})}get request(){return this._options.request}get requestError(){return this._options.requestError}};y.ApiRequestError=Qr;var zr=class extends mt{constructor(e,t){super(e);this.type=ht.Response,Error.captureStackTrace(this,this.constructor),Object.defineProperty(this,"_options",{value:t}),this.code=t.code,this.headers=t.headers,this.rateLimit=t.rateLimit,this.data=t.data}get request(){return this._options.request}get response(){return this._options.response}hasErrorCode(...e){let t=this.errors;if(!(t==null?void 0:t.length))return!1;if("code"in t[0])return t.some(n=>e.includes(n.code));let s=this.data;return e.includes(s.type)}get errors(){var e;return(e=this.data)===null||e===void 0?void 0:e.errors}get rateLimitError(){return this.code===420||this.code===429}get isAuthError(){return this.code===401?!0:this.hasErrorCode(Te.AuthTimestampInvalid,Te.AuthenticationFail,Te.BadAuthenticationData,Te.InvalidOrExpiredToken)}};y.ApiResponseError=zr;var Te;(function(r){r[r.InvalidCoordinates=3]="InvalidCoordinates",r[r.NoLocationFound=13]="NoLocationFound",r[r.AuthenticationFail=32]="AuthenticationFail",r[r.InvalidOrExpiredToken=89]="InvalidOrExpiredToken",r[r.UnableToVerifyCredentials=99]="UnableToVerifyCredentials",r[r.AuthTimestampInvalid=135]="AuthTimestampInvalid",r[r.BadAuthenticationData=215]="BadAuthenticationData",r[r.NoUserMatch=17]="NoUserMatch",r[r.UserNotFound=50]="UserNotFound",r[r.ResourceNotFound=34]="ResourceNotFound",r[r.TweetNotFound=144]="TweetNotFound",r[r.TweetNotVisible=179]="TweetNotVisible",r[r.NotAllowedResource=220]="NotAllowedResource",r[r.MediaIdNotFound=325]="MediaIdNotFound",r[r.TweetNoLongerAvailable=421]="TweetNoLongerAvailable",r[r.TweetViolatedRules=422]="TweetViolatedRules",r[r.TargetUserSuspended=63]="TargetUserSuspended",r[r.YouAreSuspended=64]="YouAreSuspended",r[r.AccountUpdateFailed=120]="AccountUpdateFailed",r[r.NoSelfSpamReport=36]="NoSelfSpamReport",r[r.NoSelfMute=271]="NoSelfMute",r[r.AccountLocked=326]="AccountLocked",r[r.RateLimitExceeded=88]="RateLimitExceeded",r[r.NoDMRightForApp=93]="NoDMRightForApp",r[r.OverCapacity=130]="OverCapacity",r[r.InternalError=131]="InternalError",r[r.TooManyFollowings=161]="TooManyFollowings",r[r.TweetLimitExceeded=185]="TweetLimitExceeded",r[r.DuplicatedTweet=187]="DuplicatedTweet",r[r.TooManySpamReports=205]="TooManySpamReports",r[r.RequestLooksLikeSpam=226]="RequestLooksLikeSpam",r[r.NoWriteRightForApp=261]="NoWriteRightForApp",r[r.TweetActionsDisabled=425]="TweetActionsDisabled",r[r.TweetRepliesRestricted=433]="TweetRepliesRestricted",r[r.NamedParameterMissing=38]="NamedParameterMissing",r[r.InvalidAttachmentUrl=44]="InvalidAttachmentUrl",r[r.TweetTextTooLong=186]="TweetTextTooLong",r[r.MissingUrlParameter=195]="MissingUrlParameter",r[r.NoMultipleGifs=323]="NoMultipleGifs",r[r.InvalidMediaIds=324]="InvalidMediaIds",r[r.InvalidUrl=407]="InvalidUrl",r[r.TooManyTweetAttachments=386]="TooManyTweetAttachments",r[r.StatusAlreadyFavorited=139]="StatusAlreadyFavorited",r[r.FollowRequestAlreadySent=160]="FollowRequestAlreadySent",r[r.CannotUnmuteANonMutedAccount=272]="CannotUnmuteANonMutedAccount",r[r.TweetAlreadyRetweeted=327]="TweetAlreadyRetweeted",r[r.ReplyToDeletedTweet=385]="ReplyToDeletedTweet",r[r.DMReceiverNotFollowingYou=150]="DMReceiverNotFollowingYou",r[r.UnableToSendDM=151]="UnableToSendDM",r[r.MustAllowDMFromAnyone=214]="MustAllowDMFromAnyone",r[r.CannotSendDMToThisUser=349]="CannotSendDMToThisUser",r[r.DMTextTooLong=354]="DMTextTooLong",r[r.SubscriptionAlreadyExists=355]="SubscriptionAlreadyExists",r[r.CallbackUrlNotApproved=415]="CallbackUrlNotApproved",r[r.SuspendedApplication=416]="SuspendedApplication",r[r.OobOauthIsNotAllowed=417]="OobOauthIsNotAllowed"})(Te=y.EApiV1ErrorCode||(y.EApiV1ErrorCode={}));var Ei;(function(r){r.InvalidRequest="https://api.twitter.com/2/problems/invalid-request",r.ClientForbidden="https://api.twitter.com/2/problems/client-forbidden",r.UnsupportedAuthentication="https://api.twitter.com/2/problems/unsupported-authentication",r.InvalidRules="https://api.twitter.com/2/problems/invalid-rules",r.TooManyRules="https://api.twitter.com/2/problems/rule-cap",r.DuplicatedRules="https://api.twitter.com/2/problems/duplicate-rules",r.RateLimitExceeded="https://api.twitter.com/2/problems/usage-capped",r.ConnectionError="https://api.twitter.com/2/problems/streaming-connection",r.ClientDisconnected="https://api.twitter.com/2/problems/client-disconnected",r.TwitterDisconnectedYou="https://api.twitter.com/2/problems/operational-disconnect",r.ResourceNotFound="https://api.twitter.com/2/problems/resource-not-found",r.ResourceUnauthorized="https://api.twitter.com/2/problems/not-authorized-for-resource",r.DisallowedResource="https://api.twitter.com/2/problems/disallowed-resource"})(Ei=y.EApiV2ErrorCode||(y.EApiV2ErrorCode={}))});var Jr=u(Yr=>{"use strict";Object.defineProperty(Yr,"__esModule",{value:!0})});var Gr=u(be=>{"use strict";Object.defineProperty(be,"__esModule",{value:!0});be.ETwitterStreamEvent=void 0;var $i;(function(r){r.Connected="connected",r.ConnectionError="connection error",r.ConnectionClosed="connection closed",r.ConnectionLost="connection lost",r.ReconnectAttempt="reconnect attempt",r.Reconnected="reconnected",r.ReconnectError="reconnect error",r.ReconnectLimitExceeded="reconnect limit exceeded",r.DataKeepAlive="data keep-alive",r.Data="data event content",r.DataError="data twitter error",r.TweetParseError="data tweet parse error",r.Error="stream error"})($i=be.ETwitterStreamEvent||(be.ETwitterStreamEvent={}))});var es=u(Zr=>{"use strict";Object.defineProperty(Zr,"__esModule",{value:!0})});var ce=u(q=>{"use strict";var Ci=q&&q.__createBinding||(Object.create?function(r,e,t,s){s===void 0&&(s=t),Object.defineProperty(r,s,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,s){s===void 0&&(s=t),r[s]=e[t]}),ue=q&&q.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Ci(e,r,t)};Object.defineProperty(q,"__esModule",{value:!0});ue(Or(),q);ue(Kr(),q);ue(Xr(),q);ue(Jr(),q);ue(Gr(),q);ue(es(),q)});var Ke=u(He=>{"use strict";Object.defineProperty(He,"__esModule",{value:!0});He.TwitterApiV2Settings=void 0;He.TwitterApiV2Settings={debug:!1,deprecationWarnings:!0}});var _t=u(Z=>{"use strict";var Hi=Z&&Z.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Z,"__esModule",{value:!0});Z.RequestHandlerHelper=void 0;var Ki=require("https"),Re=Ke(),Qi=Hi(Qe()),ts=ce(),ft=class{constructor(e){this.requestData=e,this.responseData=""}get hrefPathname(){let e=this.requestData.url;return e.hostname+e.pathname}isFormEncodedEndpoint(){return this.requestData.url.href.startsWith("https://api.twitter.com/oauth/")}getRateLimitFromResponse(e){let t;return e.headers["x-rate-limit-limit"]&&(t={limit:Number(e.headers["x-rate-limit-limit"]),remaining:Number(e.headers["x-rate-limit-remaining"]),reset:Number(e.headers["x-rate-limit-reset"])},this.requestData.rateLimitSaver&&this.requestData.rateLimitSaver(t)),t}createRequestError(e){return Re.TwitterApiV2Settings.debug&&console.log("Request network error:",e),new ts.ApiRequestError("Request failed.",{request:this.req,error:e})}formatV1Errors(e){return e.map(({code:t,message:s})=>`${s} (Twitter code ${t})`).join(", ")}formatV2Error(e){return`${e.title}: ${e.detail} (see ${e.type})`}createResponseError({res:e,data:t,rateLimit:s,code:i}){var n;Re.TwitterApiV2Settings.debug&&console.log("Request failed with code",i,", data:",t,"response headers:",e.headers);let a=`Request failed with code ${i}`;if((n=t==null?void 0:t.errors)===null||n===void 0?void 0:n.length){let o=t.errors;"code"in o[0]?a+=" - "+this.formatV1Errors(o):a+=" - "+this.formatV2Error(t)}return new ts.ApiResponseError(a,{code:i,data:t,headers:e.headers,request:this.req,response:e,rateLimit:s})}getParsedResponse(e){var t;let s=this.responseData;if(s.length&&((t=e.headers["content-type"])===null||t===void 0?void 0:t.includes("application/json")))s=JSON.parse(s);else if(this.isFormEncodedEndpoint()){let i={};for(let[n,a]of new URLSearchParams(s))i[n]=a;s=i}return s}requestErrorHandler(e,t){e(this.createRequestError(t))}classicResponseHandler(e,t,s){s.on("data",i=>this.responseData+=i),s.on("end",this.onResponseEndHandler.bind(this,e,t,s))}onResponseEndHandler(e,t,s){let i=this.getRateLimitFromResponse(s),n=this.getParsedResponse(s),a=s.statusCode;a>=400&&t(this.createResponseError({data:n,res:s,rateLimit:i,code:a})),Re.TwitterApiV2Settings.debug&&(console.log(`[${this.requestData.options.method} ${this.hrefPathname}]: Request succeeds with code ${s.statusCode}`),console.log("Response body:",n)),e({data:n,headers:s.headers,rateLimit:i})}streamResponseHandler(e,t,s){s.statusCode<400?(Re.TwitterApiV2Settings.debug&&console.log(`[${this.requestData.options.method} ${this.hrefPathname}]: Request succeeds with code ${s.statusCode} (starting stream)`),e({req:this.req,res:s,requestData:this.requestData})):this.classicResponseHandler(()=>{},t,s)}debugRequest(){let e=this.requestData.url;console.log(`[${this.requestData.options.method} ${this.hrefPathname}]`,this.requestData.options),e.search&&console.log("Request parameters:",[...e.searchParams.entries()].map(([t,s])=>`${t}: ${s}`)),this.requestData.body&&console.log("Request body:",this.requestData.body)}buildRequest(){Re.TwitterApiV2Settings.debug&&this.debugRequest();let e=this.requestData.url,t=e.username?`${e.username}:${e.password}`:void 0;this.req=Ki.request({...this.requestData.options,host:e.hostname,port:e.port||void 0,path:e.pathname+e.search,protocol:e.protocol,auth:t})}makeRequest(){return this.buildRequest(),new Promise((e,t)=>{let s=this.req;s.on("error",this.requestErrorHandler.bind(this,t)),s.on("response",this.classicResponseHandler.bind(this,e,t)),this.requestData.body&&s.write(this.requestData.body),s.end()})}async makeRequestAsStream(){let{req:e,res:t,requestData:s}=await this.makeRequestAndResolveWhenReady();return new Qi.default(s,e,t)}makeRequestAndResolveWhenReady(){return this.buildRequest(),new Promise((e,t)=>{let s=this.req;s.on("error",this.requestErrorHandler.bind(this,t)),s.on("response",this.streamResponseHandler.bind(this,e,t)),this.requestData.body&&s.write(this.requestData.body),s.end()})}};Z.RequestHandlerHelper=ft;Z.default=ft});var rs=u(Se=>{"use strict";Object.defineProperty(Se,"__esModule",{value:!0});Se.TweetStreamEventCombiner=void 0;var zi=require("events"),z=ce(),pt=class extends zi.EventEmitter{constructor(e){super();this.stream=e,this.stack=[],this.onStreamData=this.onStreamData.bind(this),this.onStreamError=this.onStreamError.bind(this),this.onceNewEvent=this.once.bind(this,"event"),e.on(z.ETwitterStreamEvent.Data,this.onStreamData),e.on(z.ETwitterStreamEvent.ConnectionError,this.onStreamError),e.on(z.ETwitterStreamEvent.TweetParseError,this.onStreamError),e.on(z.ETwitterStreamEvent.ConnectionClosed,this.onStreamError)}nextEvent(){return new Promise(this.onceNewEvent)}hasStack(){return this.stack.length>0}popStack(){let e=this.stack;return this.stack=[],e}destroy(){this.removeAllListeners(),this.stream.off(z.ETwitterStreamEvent.Data,this.onStreamData),this.stream.off(z.ETwitterStreamEvent.ConnectionError,this.onStreamError),this.stream.off(z.ETwitterStreamEvent.TweetParseError,this.onStreamError),this.stream.off(z.ETwitterStreamEvent.ConnectionClosed,this.onStreamError)}emitEvent(e,t){this.emit("event",{type:e,payload:t})}onStreamError(e){this.emitEvent("error",e)}onStreamData(e){this.stack.push(e),this.emitEvent("data",e)}};Se.TweetStreamEventCombiner=pt;Se.default=pt});var is=u(le=>{"use strict";Object.defineProperty(le,"__esModule",{value:!0});le.EStreamParserEvent=void 0;var Xi=require("events"),ss=class extends Xi.EventEmitter{constructor(){super(...arguments);this.currentMessage=""}push(e){this.currentMessage+=e,e=this.currentMessage;let t=e.length,s=0,i=0;for(;i<t;){if(e.slice(i,i+2)===`\r
`){let n=e.slice(s,i);if(s=i+=2,!n.length)continue;try{let a=JSON.parse(n);if(a){this.emit(gt.ParsedData,a);continue}}catch(a){this.emit(gt.ParseError,a)}}i++}this.currentMessage=e.slice(s,t)}reset(){this.currentMessage=""}};le.default=ss;var gt;(function(r){r.ParsedData="parsed data",r.ParseError="parse error"})(gt=le.EStreamParserEvent||(le.EStreamParserEvent={}))});var Qe=u(b=>{"use strict";var Yi=b&&b.__createBinding||(Object.create?function(r,e,t,s){s===void 0&&(s=t),Object.defineProperty(r,s,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,s){s===void 0&&(s=t),r[s]=e[t]}),Ji=b&&b.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Gi=b&&b.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Yi(e,r,t);return Ji(e,r),e},ns=b&&b.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(b,"__esModule",{value:!0});b.TweetStream=void 0;var Zi=require("events"),as=ns(_t()),f=ce(),en=ns(rs()),wt=Gi(is()),tn=r=>Math.min(r**2*1e3,25e3),yt=class extends Zi.EventEmitter{constructor(e,t,s){super();this.requestData=e,this.autoReconnect=!1,this.autoReconnectRetries=5,this.keepAliveTimeoutMs=1e3*120,this.nextRetryTimeout=tn,this.parser=new wt.default,this.onKeepAliveTimeout=this.onKeepAliveTimeout.bind(this),this.initEventsFromParser(),t&&s&&(this.req=t,this.res=s,this.initEventsFromRequest())}on(e,t){return super.on(e,t)}initEventsFromRequest(){if(!this.req||!this.res)throw new Error("TweetStream error: You cannot init TweetStream without a request and response object.");let e=t=>{this.emit(f.ETwitterStreamEvent.ConnectionError,t),this.emit(f.ETwitterStreamEvent.Error,{type:f.ETwitterStreamEvent.ConnectionError,error:t}),this.onConnectionError()};this.req.on("error",e),this.res.on("error",e),this.res.on("close",()=>e(new Error("Connection closed by Twitter."))),this.res.on("data",t=>{if(this.resetKeepAliveTimeout(),t.toString()===`\r
`)return this.emit(f.ETwitterStreamEvent.DataKeepAlive);this.parser.push(t.toString())}),this.resetKeepAliveTimeout()}initEventsFromParser(){let e=this.requestData.payloadIsError;this.parser.on(wt.EStreamParserEvent.ParsedData,t=>{e&&e(t)?(this.emit(f.ETwitterStreamEvent.DataError,t),this.emit(f.ETwitterStreamEvent.Error,{type:f.ETwitterStreamEvent.DataError,error:t})):this.emit(f.ETwitterStreamEvent.Data,t)}),this.parser.on(wt.EStreamParserEvent.ParseError,t=>{this.emit(f.ETwitterStreamEvent.TweetParseError,t),this.emit(f.ETwitterStreamEvent.Error,{type:f.ETwitterStreamEvent.TweetParseError,error:t})})}resetKeepAliveTimeout(){this.unbindKeepAliveTimeout(),this.keepAliveTimeoutMs!==1/0&&(this.keepAliveTimeout=setTimeout(this.onKeepAliveTimeout,this.keepAliveTimeoutMs))}onKeepAliveTimeout(){this.emit(f.ETwitterStreamEvent.ConnectionLost),this.onConnectionError()}unbindTimeouts(){this.unbindRetryTimeout(),this.unbindKeepAliveTimeout()}unbindKeepAliveTimeout(){this.keepAliveTimeout&&(clearTimeout(this.keepAliveTimeout),this.keepAliveTimeout=void 0)}unbindRetryTimeout(){this.retryTimeout&&(clearTimeout(this.retryTimeout),this.retryTimeout=void 0)}closeWithoutEmit(){this.unbindTimeouts(),this.res&&this.res.removeAllListeners(),this.req&&(this.req.removeAllListeners(),this.req.destroy())}close(){this.emit(f.ETwitterStreamEvent.ConnectionClosed),this.closeWithoutEmit()}destroy(){this.removeAllListeners(),this.close()}async clone(){let t=await new as.default(this.requestData).makeRequestAsStream(),s=this.eventNames();for(let i of s){let n=this.listeners(i);for(let a of n)t.on(i,a)}return t}async connect(e={}){return typeof e.autoReconnect!="undefined"&&(this.autoReconnect=e.autoReconnect),typeof e.autoReconnectRetries!="undefined"&&(this.autoReconnectRetries=e.autoReconnectRetries==="unlimited"?1/0:e.autoReconnectRetries),typeof e.keepAliveTimeout!="undefined"&&(this.keepAliveTimeoutMs=e.keepAliveTimeout==="disable"?1/0:e.keepAliveTimeout),typeof e.nextRetryTimeout!="undefined"&&(this.nextRetryTimeout=e.nextRetryTimeout),await this.reconnect(),this}async reconnect(){let e=!0;this.req&&(e=!1,this.req.destroyed||this.closeWithoutEmit());let{req:t,res:s}=await new as.default(this.requestData).makeRequestAndResolveWhenReady();this.req=t,this.res=s,this.emit(e?f.ETwitterStreamEvent.Connected:f.ETwitterStreamEvent.Reconnected),this.parser.reset(),this.initEventsFromRequest()}async onConnectionError(e=0){if(this.unbindTimeouts(),this.req&&!this.req.destroyed&&this.closeWithoutEmit(),!this.autoReconnect){this.emit(f.ETwitterStreamEvent.ConnectionClosed);return}if(e>=this.autoReconnectRetries){this.emit(f.ETwitterStreamEvent.ReconnectLimitExceeded),this.emit(f.ETwitterStreamEvent.ConnectionClosed);return}try{this.emit(f.ETwitterStreamEvent.ReconnectAttempt,e),await this.reconnect()}catch{this.emit(f.ETwitterStreamEvent.ReconnectError,e),this.emit(f.ETwitterStreamEvent.Error,{type:f.ETwitterStreamEvent.ReconnectError,error:new Error(`Reconnect error - ${e+1} attempts made yet.`)}),this.makeAutoReconnectRetry(e)}}makeAutoReconnectRetry(e){let t=this.nextRetryTimeout(e+1);this.retryTimeout=setTimeout(()=>{this.onConnectionError(e+1)},t)}async*[Symbol.asyncIterator](){let e=new en.default(this);try{for(;;){if(!this.req||this.req.aborted)throw new Error("Connection closed");e.hasStack()&&(yield*e.popStack());let{type:t,payload:s}=await e.nextEvent();if(t==="error")throw s}}finally{e.destroy()}}};b.TweetStream=yt;b.default=yt});var de=u(L=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0});L.safeDeprecationWarning=L.hasMultipleItems=L.isTweetStreamV2ErrorPayload=L.trimUndefinedProperties=L.arrayWrap=void 0;var rn=Ke();function sn(r){return Array.isArray(r)?r:[r]}L.arrayWrap=sn;function nn(r){for(let e in r)r[e]===void 0&&delete r[e]}L.trimUndefinedProperties=nn;function an(r){return typeof r=="object"&&"errors"in r&&!("data"in r)}L.isTweetStreamV2ErrorPayload=an;function on(r){return Array.isArray(r)&&r.length>1?!0:r.toString().includes(",")}L.hasMultipleItems=on;var os=new Set;function un(r){if(typeof console=="undefined"||!console.warn||!rn.TwitterApiV2Settings.deprecationWarnings)return;let e=`${r.instance}-${r.method}-${r.problem}`;if(os.has(e))return;let t=`[twitter-api-v2] Deprecation warning: In ${r.instance}.${r.method}() call, ${r.problem}.
${r.resolution}.`;console.warn(t),console.warn("To disable this message, import TwitterApiV2Settings from twitter-api-v2 and set TwitterApiV2Settings.deprecationWarnings to false."),os.add(e)}L.safeDeprecationWarning=un});var ls=u(A=>{"use strict";var cn=A&&A.__createBinding||(Object.create?function(r,e,t,s){s===void 0&&(s=t),Object.defineProperty(r,s,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,s){s===void 0&&(s=t),r[s]=e[t]}),ln=A&&A.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),dn=A&&A.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&cn(e,r,t);return ln(e,r),e};Object.defineProperty(A,"__esModule",{value:!0});A.OAuth1Helper=void 0;var hn=dn(require("crypto")),vt=class{constructor(e){this.nonceLength=32,this.consumerKeys=e.consumerKeys}hash(e,t){return hn.createHmac("sha1",t).update(e).digest("base64")}authorize(e,t={}){let s={oauth_consumer_key:this.consumerKeys.key,oauth_nonce:this.getNonce(),oauth_signature_method:"HMAC-SHA1",oauth_timestamp:this.getTimestamp(),oauth_version:"1.0"};return t.key!==void 0&&(s.oauth_token=t.key),e.data||(e.data={}),s.oauth_signature=this.getSignature(e,t.secret,s),s}toHeader(e){let t=cs(e),s="OAuth ";for(let i of t)i.key.indexOf("oauth_")===0&&(s+=$(i.key)+'="'+$(i.value)+'",');return{Authorization:s.slice(0,s.length-1)}}getNonce(){let e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",t="";for(let s=0;s<this.nonceLength;s++)t+=e[Math.trunc(Math.random()*e.length)];return t}getTimestamp(){return Math.trunc(new Date().getTime()/1e3)}getSignature(e,t,s){return this.hash(this.getBaseString(e,s),this.getSigningKey(t))}getSigningKey(e){return $(this.consumerKeys.secret)+"&"+$(e||"")}getBaseString(e,t){return e.method.toUpperCase()+"&"+$(this.getBaseUrl(e.url))+"&"+$(this.getParameterString(e,t))}getParameterString(e,t){let s=cs(_n(us(t,us(e.data,fn(e.url))))),i="";for(let{key:n,value:a}of s)if(a&&Array.isArray(a)){a.sort();let o="";a.forEach((l,h)=>{o+=n+"="+l,h<a.length&&(o+="&")}),i+=o}else i+=n+"="+a+"&";return i.slice(0,i.length-1)}getBaseUrl(e){return e.split("?")[0]}};A.OAuth1Helper=vt;A.default=vt;function us(r,e){return{...r||{},...e||{}}}function cs(r){return Object.keys(r).sort().map(e=>({key:e,value:r[e]}))}function mn(r){let e=r.split("&"),t={};for(let s of e){let[i,n=""]=s.split("=");t[i]?(Array.isArray(t[i])||(t[i]=[t[i]]),t[i].push(decodeURIComponent(n))):t[i]=decodeURIComponent(n)}return t}function fn(r){let e=r.split("?");return e.length===1?{}:mn(e[1])}function $(r){return encodeURIComponent(r).replace(/!/g,"%21").replace(/\*/g,"%2A").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29")}function _n(r){let e={};for(let t in r){let s=r[t];s&&Array.isArray(s)?s=s.map(i=>$(i)):s=$(s),e[$(t)]=s}return e}});var ds=u(ze=>{"use strict";Object.defineProperty(ze,"__esModule",{value:!0});ze.FormDataHelper=void 0;var pn=de(),O=class{constructor(){this._boundary="",this._chunks=[]}bodyAppend(...e){let t=e.map(s=>s instanceof Buffer?s:Buffer.from(s));this._chunks.push(...t)}append(e,t,s){let i=t instanceof Buffer?t:t.toString(),n=this.getMultipartHeader(e,i,s);this.bodyAppend(n,i,O.LINE_BREAK)}getHeaders(){return{"content-type":"multipart/form-data; boundary="+this.getBoundary()}}getLength(){return this._chunks.reduce((e,t)=>e+t.length,this.getMultipartFooter().length)}getBuffer(){let e=[...this._chunks,this.getMultipartFooter()],t=Buffer.alloc(this.getLength()),s=0;for(let i of e)for(let n=0;n<i.length;s++,n++)t[s]=i[n];return t}getBoundary(){return this._boundary||this.generateBoundary(),this._boundary}generateBoundary(){let e="--------------------------";for(let t=0;t<24;t++)e+=Math.floor(Math.random()*10).toString(16);this._boundary=e}getMultipartHeader(e,t,s){s||(s=t instanceof Buffer?O.DEFAULT_CONTENT_TYPE:"");let i={"Content-Disposition":["form-data",`name="${e}"`],"Content-Type":s},n="";for(let[a,o]of Object.entries(i))!o.length||(n+=a+": "+pn.arrayWrap(o).join("; ")+O.LINE_BREAK);return"--"+this.getBoundary()+O.LINE_BREAK+n+O.LINE_BREAK}getMultipartFooter(){return this._footerChunk?this._footerChunk:this._footerChunk=Buffer.from("--"+this.getBoundary()+"--"+O.LINE_BREAK)}};ze.FormDataHelper=O;O.LINE_BREAK=`\r
`;O.DEFAULT_CONTENT_TYPE="application/octet-stream"});var hs=u(De=>{"use strict";Object.defineProperty(De,"__esModule",{value:!0});De.RequestParamHelpers=void 0;var gn=ds(),Xe=class{static formatQueryToString(e){let t={};for(let s in e)typeof e[s]=="string"?t[s]=e[s]:typeof e[s]!="undefined"&&(t[s]=String(e[s]));return t}static autoDetectBodyType(e){if(e.pathname.startsWith("/2/")||e.pathname.startsWith("/labs/2/"))return e.password.startsWith("/2/oauth2")?"url":"json";if(e.hostname==="upload.twitter.com")return e.pathname==="/1.1/media/upload.json"?"form-data":"json";let t=e.pathname.split("/1.1/",2)[1];return this.JSON_1_1_ENDPOINTS.has(t)?"json":"url"}static addQueryParamsToUrl(e,t){for(let[s,i]of Object.entries(t))e.searchParams.append(s,i);e.search&&(e.search=e.search.replace(/\*/g,"%2A"))}static constructBodyParams(e,t,s){if(e instanceof Buffer)return e;if(s==="json")return t["content-type"]="application/json;charset=UTF-8",JSON.stringify(e);if(s==="url")return t["content-type"]="application/x-www-form-urlencoded;charset=UTF-8",Object.keys(e).length?new URLSearchParams(e).toString().replace(/\*/g,"%2A"):"";if(s==="raw")throw new Error("You can only use raw body mode with Buffers. To give a string, use Buffer.from(str).");{let i=new gn.FormDataHelper;for(let a in e)i.append(a,e[a]);let n=i.getHeaders();return t["content-type"]=n["content-type"],i.getBuffer()}}static setBodyLengthHeader(e,t){var s;e.headers=(s=e.headers)!==null&&s!==void 0?s:{},typeof t=="string"?e.headers["content-length"]=Buffer.byteLength(t):e.headers["content-length"]=t.length}static isOAuthSerializable(e){return!(e instanceof Buffer)}static mergeQueryAndBodyForOAuth(e,t){let s={};for(let i in e)s[i]=e[i];if(this.isOAuthSerializable(t))for(let i in t){let n=t[i];this.isOAuthSerializable(n)&&(s[i]=typeof n=="object"&&n!==null&&"toString"in n?n.toString():n)}return s}static moveUrlQueryParamsIntoObject(e,t){for(let[s,i]of e.searchParams)t[s]=i;return e.search="",e}static applyRequestParametersToUrl(e,t){return e.pathname=e.pathname.replace(/:([A-Z_-]+)/ig,(s,i)=>t[i]!==void 0?String(t[i]):s),e}};De.RequestParamHelpers=Xe;Xe.JSON_1_1_ENDPOINTS=new Set(["direct_messages/events/new.json","direct_messages/welcome_messages/new.json","direct_messages/welcome_messages/rules/new.json","media/metadata/create.json","collections/entries/curate.json"]);De.default=Xe});var ms=u(me=>{"use strict";var Ye=me&&me.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(me,"__esModule",{value:!0});me.ClientRequestMaker=void 0;var wn=Ye(Qe()),yn=de(),vn=Ye(ls()),Pn=Ye(_t()),C=Ye(hs()),he=class{constructor(){this._rateLimits={}}saveRateLimit(e,t){this._rateLimits[e]=t}send(e){let t=this.getHttpRequestArgs(e),s={method:t.method,headers:t.headers},i=e.enableRateLimitSave!==!1;return t.body&&C.default.setBodyLengthHeader(s,t.body),new Pn.default({url:t.url,options:s,body:t.body,rateLimitSaver:i?this.saveRateLimit.bind(this,t.rawUrl):void 0}).makeRequest()}sendStream(e){let t=this.getHttpRequestArgs(e),s={method:t.method,headers:t.headers},i=e.enableRateLimitSave!==!1,n=e.autoConnect!==!1;t.body&&C.default.setBodyLengthHeader(s,t.body);let a={url:t.url,options:s,body:t.body,rateLimitSaver:i?this.saveRateLimit.bind(this,t.rawUrl):void 0,payloadIsError:e.payloadIsError},o=new wn.default(a);return n?o.connect():o}buildOAuth(){if(!this._consumerSecret||!this._consumerToken)throw new Error("Invalid consumer tokens");return new vn.default({consumerKeys:{key:this._consumerToken,secret:this._consumerSecret}})}getOAuthAccessTokens(){if(!(!this._accessSecret||!this._accessToken))return{key:this._accessToken,secret:this._accessSecret}}writeAuthHeaders({headers:e,bodyInSignature:t,url:s,method:i,query:n,body:a}){if(e={...e},this._bearerToken)e.Authorization="Bearer "+this._bearerToken;else if(this._basicToken)e.Authorization="Basic "+this._basicToken;else if(this._consumerSecret&&this._oauth){let o=t?C.default.mergeQueryAndBodyForOAuth(n,a):n,l=this._oauth.authorize({url:s.toString(),method:i,data:o},this.getOAuthAccessTokens());e={...e,...this._oauth.toHeader(l)}}return e}getHttpRequestArgs({url:e,method:t,query:s={},body:i={},headers:n,forceBodyMode:a,enableAuth:o,params:l}){let h;t=t.toUpperCase(),n=n??{},n["x-user-agent"]||(n["x-user-agent"]="Node.twitter-api-v2"),e.startsWith("http")||(e="https://"+e);let d=new URL(e),v=d.origin+d.pathname;l&&C.default.applyRequestParametersToUrl(d,l);let T=C.default.formatQueryToString(s);C.default.moveUrlQueryParamsIntoObject(d,T),i instanceof Buffer||yn.trimUndefinedProperties(i);let H=a??C.default.autoDetectBodyType(d);if(o!==!1){let W=he.BODY_METHODS.has(t)&&H==="url";n=this.writeAuthHeaders({headers:n,bodyInSignature:W,method:t,query:T,url:d,body:i})}return he.BODY_METHODS.has(t)&&(h=C.default.constructBodyParams(i,n,H)||void 0),C.default.addQueryParamsToUrl(d,T),{rawUrl:v,url:d,method:t,headers:n,body:h}}};me.ClientRequestMaker=he;he.BODY_METHODS=new Set(["POST","PUT","PATCH"])});var Tt=u(Pt=>{"use strict";Object.defineProperty(Pt,"__esModule",{value:!0});var Tn=ms(),Je=class extends Tn.ClientRequestMaker{constructor(e){super();if(this._currentUser=null,typeof e=="string")this._bearerToken=e;else if(e instanceof Je)this._accessToken=e._accessToken,this._accessSecret=e._accessSecret,this._consumerToken=e._consumerToken,this._consumerSecret=e._consumerSecret,this._oauth=e._oauth,this._prefix=e._prefix,this._bearerToken=e._bearerToken,this._basicToken=e._basicToken,this._clientId=e._clientId,this._rateLimits=e._rateLimits;else if(typeof e=="object"&&"appKey"in e)this._consumerToken=e.appKey,this._consumerSecret=e.appSecret,e.accessToken&&e.accessSecret&&(this._accessToken=e.accessToken,this._accessSecret=e.accessSecret),this._oauth=this.buildOAuth();else if(typeof e=="object"&&"username"in e){let t=encodeURIComponent(e.username)+":"+encodeURIComponent(e.password);this._basicToken=Buffer.from(t).toString("base64")}else typeof e=="object"&&"clientId"in e&&(this._clientId=e.clientId)}setPrefix(e){this._prefix=e}cloneWithPrefix(e){let t=this.constructor(this);return t.setPrefix(e),t}getActiveTokens(){return this._bearerToken?{type:"oauth2",bearerToken:this._bearerToken}:this._basicToken?{type:"basic",token:this._basicToken}:this._consumerSecret&&this._oauth?{type:"oauth-1.0a",appKey:this._consumerToken,appSecret:this._consumerSecret,accessToken:this._accessToken,accessSecret:this._accessSecret}:{type:"none"}}hasHitRateLimit(e){var t;return this.isRateLimitStatusObsolete(e)?!1:((t=this.getLastRateLimitStatus(e))===null||t===void 0?void 0:t.remaining)===0}isRateLimitStatusObsolete(e){let t=this.getLastRateLimitStatus(e);return t===void 0?!0:t.reset*1e3<Date.now()}getLastRateLimitStatus(e){let t=e.match(/^https?:\/\//)?e:this._prefix+e;return this._rateLimits[t]}async getCurrentUserObject(e=!1){if(!e&&this._currentUser)return this._currentUser;let t=await this.get("account/verify_credentials.json",{tweet_mode:"extended"},{prefix:"https://api.twitter.com/1.1/"});return this._currentUser=t,t}async get(e,t={},{fullResponse:s,prefix:i=this._prefix,...n}={}){i&&(e=i+e);let a=await this.send({url:e,method:"GET",query:t,...n});return s?a:a.data}async delete(e,t={},{fullResponse:s,prefix:i=this._prefix,...n}={}){i&&(e=i+e);let a=await this.send({url:e,method:"DELETE",query:t,...n});return s?a:a.data}async post(e,t,{fullResponse:s,prefix:i=this._prefix,...n}={}){i&&(e=i+e);let a=await this.send({url:e,method:"POST",body:t,...n});return s?a:a.data}async put(e,t,{fullResponse:s,prefix:i=this._prefix,...n}={}){i&&(e=i+e);let a=await this.send({url:e,method:"PUT",body:t,...n});return s?a:a.data}async patch(e,t,{fullResponse:s,prefix:i=this._prefix,...n}={}){i&&(e=i+e);let a=await this.send({url:e,method:"PATCH",body:t,...n});return s?a:a.data}getStream(e,t,{prefix:s=this._prefix,...i}={}){return this.sendStream({url:s?s+e:e,method:"GET",query:t,...i})}postStream(e,t,{prefix:s=this._prefix,...i}={}){return this.sendStream({url:s?s+e:e,method:"POST",body:t,...i})}};Pt.default=Je});var Ge=u(qe=>{"use strict";var bn=qe&&qe.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(qe,"__esModule",{value:!0});var fs=bn(Tt()),_s=class extends fs.default{constructor(e){super();if(!(e instanceof fs.default))throw new Error("You must instance TwitterApiv1 instance from existing TwitterApi instance.");let t=e;this._bearerToken=t._bearerToken,this._consumerToken=t._consumerToken,this._consumerSecret=t._consumerSecret,this._accessToken=t._accessToken,this._accessSecret=t._accessSecret,this._basicToken=t._basicToken,this._oauth=t._oauth,this._clientId=t._clientId,this._rateLimits=t._rateLimits}};qe.default=_s});var bt=u(j=>{"use strict";var Rn=j&&j.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(j,"__esModule",{value:!0});j.ListTimelineV1Paginator=j.UserTimelineV1Paginator=j.MentionTimelineV1Paginator=j.HomeTimelineV1Paginator=void 0;var Sn=Rn(G()),Le=class extends Sn.default{refreshInstanceFromResult(e,t){let s=e.data;this._rateLimit=e.rateLimit,t&&this._realData.push(...s)}getNextQueryParams(e){let t=BigInt(this._realData[this._realData.length-1].id_str);return{...this.injectQueryParams(e),max_id:(t-BigInt(1)).toString()}}getPageLengthFromRequest(e){return e.data.length}isFetchLastOver(e){return!e.data.length}getItemArray(){return this.tweets}get tweets(){return this._realData}},ps=class extends Le{constructor(){super(...arguments);this._endpoint="statuses/home_timeline.json"}};j.HomeTimelineV1Paginator=ps;var gs=class extends Le{constructor(){super(...arguments);this._endpoint="statuses/mentions_timeline.json"}};j.MentionTimelineV1Paginator=gs;var ws=class extends Le{constructor(){super(...arguments);this._endpoint="statuses/user_timeline.json"}};j.UserTimelineV1Paginator=ws;var ys=class extends Le{constructor(){super(...arguments);this._endpoint="lists/statuses.json"}};j.ListTimelineV1Paginator=ys});var Rt=u(fe=>{"use strict";Object.defineProperty(fe,"__esModule",{value:!0});fe.MuteUserIdsV1Paginator=fe.MuteUserListV1Paginator=void 0;var vs=ve(),Ps=class extends vs.CursoredV1Paginator{constructor(){super(...arguments);this._endpoint="mutes/users/list.json"}refreshInstanceFromResult(e,t){let s=e.data;this._rateLimit=e.rateLimit,t&&(this._realData.users.push(...s.users),this._realData.next_cursor=s.next_cursor)}getPageLengthFromRequest(e){return e.data.users.length}getItemArray(){return this.users}get users(){return this._realData.users}};fe.MuteUserListV1Paginator=Ps;var Ts=class extends vs.CursoredV1Paginator{constructor(){super(...arguments);this._endpoint="mutes/users/ids.json",this._maxResultsWhenFetchLast=5e3}refreshInstanceFromResult(e,t){let s=e.data;this._rateLimit=e.rateLimit,t&&(this._realData.ids.push(...s.ids),this._realData.next_cursor=s.next_cursor)}getPageLengthFromRequest(e){return e.data.ids.length}getItemArray(){return this.ids}get ids(){return this._realData.ids}};fe.MuteUserIdsV1Paginator=Ts});var Dt=u(k=>{"use strict";var Dn=k&&k.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(k,"__esModule",{value:!0});k.FriendshipsOutgoingV1Paginator=k.FriendshipsIncomingV1Paginator=k.UserSearchV1Paginator=void 0;var qn=Dn(G()),Ln=ve(),bs=class extends qn.default{constructor(){super(...arguments);this._endpoint="users/search.json"}refreshInstanceFromResult(e,t){let s=e.data;this._rateLimit=e.rateLimit,t&&this._realData.push(...s)}getNextQueryParams(e){var t;let s=Number((t=this._queryParams.page)!==null&&t!==void 0?t:"1");return{...this._queryParams,page:s+1,...e?{count:e}:{}}}getPageLengthFromRequest(e){return e.data.length}isFetchLastOver(e){return!e.data.length}getItemArray(){return this.users}get users(){return this._realData}};k.UserSearchV1Paginator=bs;var St=class extends Ln.CursoredV1Paginator{constructor(){super(...arguments);this._endpoint="friendships/incoming.json",this._maxResultsWhenFetchLast=5e3}refreshInstanceFromResult(e,t){let s=e.data;this._rateLimit=e.rateLimit,t&&(this._realData.ids.push(...s.ids),this._realData.next_cursor=s.next_cursor)}getPageLengthFromRequest(e){return e.data.ids.length}getItemArray(){return this.ids}get ids(){return this._realData.ids}};k.FriendshipsIncomingV1Paginator=St;var Rs=class extends St{constructor(){super(...arguments);this._endpoint="friendships/outgoing.json"}};k.FriendshipsOutgoingV1Paginator=Rs});var Lt=u(I=>{"use strict";Object.defineProperty(I,"__esModule",{value:!0});I.ListSubscribersV1Paginator=I.ListMembersV1Paginator=I.ListSubscriptionsV1Paginator=I.ListOwnershipsV1Paginator=I.ListMembershipsV1Paginator=void 0;var Ss=ve(),Ze=class extends Ss.CursoredV1Paginator{refreshInstanceFromResult(e,t){let s=e.data;this._rateLimit=e.rateLimit,t&&(this._realData.lists.push(...s.lists),this._realData.next_cursor=s.next_cursor)}getPageLengthFromRequest(e){return e.data.lists.length}getItemArray(){return this.lists}get lists(){return this._realData.lists}},Ds=class extends Ze{constructor(){super(...arguments);this._endpoint="lists/memberships.json"}};I.ListMembershipsV1Paginator=Ds;var qs=class extends Ze{constructor(){super(...arguments);this._endpoint="lists/ownerships.json"}};I.ListOwnershipsV1Paginator=qs;var Ls=class extends Ze{constructor(){super(...arguments);this._endpoint="lists/subscriptions.json"}};I.ListSubscriptionsV1Paginator=Ls;var qt=class extends Ss.CursoredV1Paginator{refreshInstanceFromResult(e,t){let s=e.data;this._rateLimit=e.rateLimit,t&&(this._realData.users.push(...s.users),this._realData.next_cursor=s.next_cursor)}getPageLengthFromRequest(e){return e.data.users.length}getItemArray(){return this.users}get users(){return this._realData.users}},js=class extends qt{constructor(){super(...arguments);this._endpoint="lists/members.json"}};I.ListMembersV1Paginator=js;var Is=class extends qt{constructor(){super(...arguments);this._endpoint="lists/subscribers.json"}};I.ListSubscribersV1Paginator=Is});var Mt=u(Me=>{"use strict";var Ms=Me&&Me.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Me,"__esModule",{value:!0});var jn=Ms(Ge()),jt=U(),In=de(),Mn=Ms(et()),je=bt(),As=Rt(),It=Dt(),Ie=Lt(),Os=class extends jn.default{constructor(){super(...arguments);this._prefix=jt.API_V1_1_PREFIX}singleTweet(e,t={}){return this.get("statuses/show.json",{tweet_mode:"extended",id:e,...t})}tweets(e,t={}){return this.post("statuses/lookup.json",{tweet_mode:"extended",id:e,...t})}oembedTweet(e,t={}){return this.get("oembed",{url:`https://twitter.com/i/statuses/${e}`,...t},{prefix:"https://publish.twitter.com/"})}async homeTimeline(e={}){let t={tweet_mode:"extended",...e},s=await this.get("statuses/home_timeline.json",t,{fullResponse:!0});return new je.HomeTimelineV1Paginator({realData:s.data,rateLimit:s.rateLimit,instance:this,queryParams:t})}async mentionTimeline(e={}){let t={tweet_mode:"extended",...e},s=await this.get("statuses/mentions_timeline.json",t,{fullResponse:!0});return new je.MentionTimelineV1Paginator({realData:s.data,rateLimit:s.rateLimit,instance:this,queryParams:t})}async userTimeline(e,t={}){let s={tweet_mode:"extended",user_id:e,...t},i=await this.get("statuses/user_timeline.json",s,{fullResponse:!0});return new je.UserTimelineV1Paginator({realData:i.data,rateLimit:i.rateLimit,instance:this,queryParams:s})}async userTimelineByUsername(e,t={}){let s={tweet_mode:"extended",screen_name:e,...t},i=await this.get("statuses/user_timeline.json",s,{fullResponse:!0});return new je.UserTimelineV1Paginator({realData:i.data,rateLimit:i.rateLimit,instance:this,queryParams:s})}user(e){return this.get("users/show.json",{tweet_mode:"extended",...e})}users(e){return this.get("users/lookup.json",{tweet_mode:"extended",...e})}verifyCredentials(e={}){return this.get("account/verify_credentials.json",e)}async listMutedUsers(e={}){let t={tweet_mode:"extended",...e},s=await this.get("mutes/users/list.json",t,{fullResponse:!0});return new As.MuteUserListV1Paginator({realData:s.data,rateLimit:s.rateLimit,instance:this,queryParams:t})}async listMutedUserIds(e={}){let t={stringify_ids:!0,...e},s=await this.get("mutes/users/ids.json",t,{fullResponse:!0});return new As.MuteUserIdsV1Paginator({realData:s.data,rateLimit:s.rateLimit,instance:this,queryParams:t})}async searchUsers(e,t={}){let s={q:e,tweet_mode:"extended",page:1,...t},i=await this.get("users/search.json",s,{fullResponse:!0});return new It.UserSearchV1Paginator({realData:i.data,rateLimit:i.rateLimit,instance:this,queryParams:s})}friendship(e){return this.get("friendships/show.json",e)}friendships(e){return this.get("friendships/lookup.json",e)}friendshipsNoRetweets(){return this.get("friendships/no_retweets/ids.json",{stringify_ids:!0})}async friendshipsIncoming(e={}){let t={stringify_ids:!0,...e},s=await this.get("friendships/incoming.json",t,{fullResponse:!0});return new It.FriendshipsIncomingV1Paginator({realData:s.data,rateLimit:s.rateLimit,instance:this,queryParams:t})}async friendshipsOutgoing(e={}){let t={stringify_ids:!0,...e},s=await this.get("friendships/outgoing.json",t,{fullResponse:!0});return new It.FriendshipsOutgoingV1Paginator({realData:s.data,rateLimit:s.rateLimit,instance:this,queryParams:t})}accountSettings(){return this.get("account/settings.json")}userProfileBannerSizes(e){return this.get("users/profile_banner.json",e)}list(e){return this.get("lists/show.json",{tweet_mode:"extended",...e})}lists(e={}){return this.get("lists/list.json",{tweet_mode:"extended",...e})}async listMembers(e={}){let t={tweet_mode:"extended",...e},s=await this.get("lists/members.json",t,{fullResponse:!0});return new Ie.ListMembersV1Paginator({realData:s.data,rateLimit:s.rateLimit,instance:this,queryParams:t})}listGetMember(e){return this.get("lists/members/show.json",{tweet_mode:"extended",...e})}async listMemberships(e={}){let t={tweet_mode:"extended",...e},s=await this.get("lists/memberships.json",t,{fullResponse:!0});return new Ie.ListMembershipsV1Paginator({realData:s.data,rateLimit:s.rateLimit,instance:this,queryParams:t})}async listOwnerships(e={}){let t={tweet_mode:"extended",...e},s=await this.get("lists/ownerships.json",t,{fullResponse:!0});return new Ie.ListOwnershipsV1Paginator({realData:s.data,rateLimit:s.rateLimit,instance:this,queryParams:t})}async listStatuses(e){let t={tweet_mode:"extended",...e},s=await this.get("lists/statuses.json",t,{fullResponse:!0});return new je.ListTimelineV1Paginator({realData:s.data,rateLimit:s.rateLimit,instance:this,queryParams:t})}async listSubscribers(e={}){let t={tweet_mode:"extended",...e},s=await this.get("lists/subscribers.json",t,{fullResponse:!0});return new Ie.ListSubscribersV1Paginator({realData:s.data,rateLimit:s.rateLimit,instance:this,queryParams:t})}listGetSubscriber(e){return this.get("lists/subscribers/show.json",{tweet_mode:"extended",...e})}async listSubscriptions(e={}){let t={tweet_mode:"extended",...e},s=await this.get("lists/subscriptions.json",t,{fullResponse:!0});return new Ie.ListSubscriptionsV1Paginator({realData:s.data,rateLimit:s.rateLimit,instance:this,queryParams:t})}mediaInfo(e){return this.get("media/upload.json",{command:"STATUS",media_id:e},{prefix:jt.API_V1_1_UPLOAD_PREFIX})}filterStream({autoConnect:e,...t}={}){let s={};for(let[n,a]of Object.entries(t))if(n==="follow"||n==="track")s[n]=a.toString();else if(n==="locations"){let o=a;s.locations=In.arrayWrap(o).map(l=>`${l.lng},${l.lat}`).join(",")}else s[n]=a;return this.stream.postStream("statuses/filter.json",s,{autoConnect:e})}sampleStream({autoConnect:e,...t}={}){return this.stream.getStream("statuses/sample.json",t,{autoConnect:e})}get stream(){let e=new Mn.default(this);return e.setPrefix(jt.API_V1_1_STREAM_PREFIX),e}trendsByPlace(e,t={}){return this.get("trends/place.json",{id:e,...t})}trendsAvailable(){return this.get("trends/available.json")}trendsClosest(e,t){return this.get("trends/closest.json",{lat:e,long:t})}geoPlace(e){return this.get("geo/id/:place_id.json",void 0,{params:{place_id:e}})}geoSearch(e){return this.get("geo/search.json",e)}geoReverseGeoCode(e){return this.get("geo/reverse_geocode.json",e)}rateLimitStatuses(...e){return this.get("application/rate_limit_status.json",{resources:e})}supportedLanguages(){return this.get("help/languages.json")}};Me.default=Os});var Fs=u(_=>{"use strict";var An=_&&_.__createBinding||(Object.create?function(r,e,t,s){s===void 0&&(s=t),Object.defineProperty(r,s,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,s){s===void 0&&(s=t),r[s]=e[t]}),On=_&&_.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),xn=_&&_.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&An(e,r,t);return On(e,r),e};Object.defineProperty(_,"__esModule",{value:!0});_.readNextPartOf=_.sleepSecs=_.getMediaCategoryByMime=_.getMimeType=_.getFileSizeFromFileHandle=_.getFileHandle=_.readFileIntoBuffer=void 0;var tt=xn(require("fs"));async function Fn(r){let e=await xs(r);return typeof e=="number"?new Promise((t,s)=>{tt.readFile(e,(i,n)=>{if(i)return s(i);t(n)})}):e instanceof Buffer?e:e.readFile()}_.readFileIntoBuffer=Fn;function xs(r){if(typeof r=="string")return tt.promises.open(r,"r");if(typeof r=="number")return r;if(typeof r=="object"&&!(r instanceof Buffer))return r;if(r instanceof Buffer)return r;throw new Error("Given file is not valid, please check its type.")}_.getFileHandle=xs;async function Un(r){return typeof r=="number"?(await new Promise((t,s)=>{tt.fstat(r,(i,n)=>{i&&s(i),t(n)})})).size:r instanceof Buffer?r.length:(await r.stat()).size}_.getFileSizeFromFileHandle=Un;function kn(r,e){if(typeof r=="string"&&!e)return Bn(r);if(typeof e=="string")return Nn(e);throw new Error("You must specify type if file is a file handle or Buffer.")}_.getMimeType=kn;function Bn(r){return r.endsWith(".jpeg")||r.endsWith(".jpg")?"image/jpeg":r.endsWith(".png")?"image/png":r.endsWith(".webp")?"image/webp":r.endsWith(".gif")?"image/gif":r.endsWith(".mpeg4")||r.endsWith(".mp4")?"video/mp4":r.endsWith(".srt")?"text/plain":"image/jpeg"}function Nn(r){return r==="gif"?"image/gif":r==="jpg"?"image/jpeg":r==="png"?"image/png":r==="webp"?"image/webp":r==="srt"?"text/plain":r==="mp4"||r==="longmp4"?"video/mp4":r}function Vn(r,e){return r==="video/mp4"?e==="tweet"?"TweetVideo":"DmVideo":r==="image/gif"?e==="tweet"?"TweetGif":"DmGif":r==="text/plain"?"Subtitles":e==="tweet"?"TweetImage":"DmImage"}_.getMediaCategoryByMime=Vn;function Wn(r){return new Promise(e=>setTimeout(e,r*1e3))}_.sleepSecs=Wn;async function En(r,e,t=0,s){if(r instanceof Buffer){let n=r.slice(t,t+e);return[n,n.length]}if(!s)throw new Error("Well, we will need a buffer to store file content.");let i;return typeof r=="number"?i=await new Promise((n,a)=>{tt.read(r,s,0,e,t,(o,l)=>{o&&a(o),n(l)})}):i=(await r.read(s,0,e,t)).bytesRead,[s,i]}_.readNextPartOf=En});var Ot=u(x=>{"use strict";var $n=x&&x.__createBinding||(Object.create?function(r,e,t,s){s===void 0&&(s=t),Object.defineProperty(r,s,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,s){s===void 0&&(s=t),r[s]=e[t]}),Cn=x&&x.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Hn=x&&x.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&$n(e,r,t);return Cn(e,r),e},Kn=x&&x.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(x,"__esModule",{value:!0});var ee=U(),Qn=Kn(Mt()),Us=Hn(require("fs")),B=Fs(),rt=de(),At="media/upload.json",ks=class extends Qn.default{constructor(){super(...arguments);this._prefix=ee.API_V1_1_PREFIX}get readOnly(){return this}tweet(e,t={}){let s={status:e,tweet_mode:"extended",...t};return this.post("statuses/update.json",s)}async tweetThread(e){let t=[];for(let s of e){let i=t.length?t[t.length-1]:null,n={...typeof s=="string"?{status:s}:s},a=i?i.id_str:n.in_reply_to_status_id,o=n.status;a?t.push(await this.reply(o,a,n)):t.push(await this.tweet(o,n))}return t}reply(e,t,s={}){return this.tweet(e,{auto_populate_reply_metadata:!0,in_reply_to_status_id:t,...s})}deleteTweet(e){return this.post("statuses/destroy/:id.json",{tweet_mode:"extended"},{params:{id:e}})}reportUserAsSpam(e){return this.post("users/report_spam.json",{tweet_mode:"extended",...e})}updateFriendship(e){return this.post("friendships/update.json",e)}updateAccountSettings(e){return this.post("account/settings.json",e)}updateAccountProfile(e){return this.post("account/update_profile.json",e)}async updateAccountProfileBanner(e,t={}){let s={banner:await B.readFileIntoBuffer(e),...t};return this.post("account/update_profile_banner.json",s,{forceBodyMode:"form-data"})}async updateAccountProfileImage(e,t={}){let s={tweet_mode:"extended",image:await B.readFileIntoBuffer(e),...t};return this.post("account/update_profile_image.json",s,{forceBodyMode:"form-data"})}removeAccountProfileBanner(){return this.post("account/remove_profile_banner.json")}createList(e){return this.post("lists/create.json",{tweet_mode:"extended",...e})}updateList(e){return this.post("lists/update.json",{tweet_mode:"extended",...e})}removeList(e){return this.post("lists/destroy.json",{tweet_mode:"extended",...e})}addListMembers(e){let s=e.user_id&&rt.hasMultipleItems(e.user_id)||e.screen_name&&rt.hasMultipleItems(e.screen_name)?"lists/members/create_all.json":"lists/members/create.json";return this.post(s,e)}removeListMembers(e){let s=e.user_id&&rt.hasMultipleItems(e.user_id)||e.screen_name&&rt.hasMultipleItems(e.screen_name)?"lists/members/destroy_all.json":"lists/members/destroy.json";return this.post(s,e)}subscribeToList(e){return this.post("lists/subscribers/create.json",{tweet_mode:"extended",...e})}unsubscribeOfList(e){return this.post("lists/subscribers/destroy.json",{tweet_mode:"extended",...e})}createMediaMetadata(e,t){return this.post("media/metadata/create.json",{media_id:e,...t},{prefix:ee.API_V1_1_UPLOAD_PREFIX,forceBodyMode:"json"})}createMediaSubtitles(e,t){return this.post("media/subtitles/create.json",{media_id:e,media_category:"TweetVideo",subtitle_info:{subtitles:t}},{prefix:ee.API_V1_1_UPLOAD_PREFIX,forceBodyMode:"json"})}deleteMediaSubtitles(e,...t){return this.post("media/subtitles/delete.json",{media_id:e,media_category:"TweetVideo",subtitle_info:{subtitles:t.map(s=>({language_code:s}))}},{prefix:ee.API_V1_1_UPLOAD_PREFIX,forceBodyMode:"json"})}async uploadMedia(e,t={}){var s;let i=(s=t.chunkLength)!==null&&s!==void 0?s:1024*1024,{fileHandle:n,mediaCategory:a,fileSize:o,mimeType:l}=await this.getUploadMediaRequirements(e,t);try{let h=await this.post(At,{command:"INIT",total_bytes:o,media_type:l,media_category:a,additional_owners:t.additionalOwners,shared:t.shared?!0:void 0},{prefix:ee.API_V1_1_UPLOAD_PREFIX});await this.mediaChunkedUpload(n,i,h.media_id_string,t.maxConcurrentUploads);let d=await this.post(At,{command:"FINALIZE",media_id:h.media_id_string},{prefix:ee.API_V1_1_UPLOAD_PREFIX});return d.processing_info&&d.processing_info.state!=="succeeded"&&await this.awaitForMediaProcessingCompletion(d),d.media_id_string}finally{typeof e=="number"?Us.close(e,()=>{}):typeof n=="object"&&!(n instanceof Buffer)&&n.close()}}async awaitForMediaProcessingCompletion(e){for(;;){if(e=await this.mediaInfo(e.media_id_string),!e.processing_info||e.processing_info.state==="succeeded")return;if(e.processing_info.state==="failed")throw new Error("Failed to process the media.");e.processing_info.check_after_secs?await B.sleepSecs(e.processing_info.check_after_secs):await B.sleepSecs(5)}}async getUploadMediaRequirements(e,{type:t,target:s}={}){let i;try{i=await B.getFileHandle(e);let n=B.getMimeType(e,t),a;return t==="longmp4"||t==="video/mp4"&&s!=="dm"?a="amplify_video":a=B.getMediaCategoryByMime(n,s??"tweet"),{fileHandle:i,mediaCategory:a,fileSize:await B.getFileSizeFromFileHandle(i),mimeType:n}}catch(n){throw typeof e=="number"?Us.close(e,()=>{}):typeof i=="object"&&!(i instanceof Buffer)&&i.close(),n}}async mediaChunkedUpload(e,t,s,i=3){let n=0;if(i<1)throw new RangeError("Bad maxConcurrentUploads parameter.");let a=e instanceof Buffer?void 0:Buffer.alloc(t),o,l,h=0;[o,l]=await B.readNextPartOf(e,t,h,a),h+=l;let d=new Set;for(;l;){let v=o.slice(0,l);if(v.length){let T=this.post(At,{command:"APPEND",media_id:s,segment_index:n,media:v},{prefix:ee.API_V1_1_UPLOAD_PREFIX});d.add(T),T.then(()=>{d.delete(T)}),n++}d.size>=i&&await Promise.race(d),[o,l]=await B.readNextPartOf(e,t,h,a),h+=l}await Promise.all([...d])}};x.default=ks});var et=u(te=>{"use strict";var zn=te&&te.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(te,"__esModule",{value:!0});te.TwitterApiv1=void 0;var Xn=U(),Bs=dt(),st=ce(),Yn=zn(Ot()),xt=class extends Yn.default{constructor(){super(...arguments);this._prefix=Xn.API_V1_1_PREFIX}get readWrite(){return this}sendDm({recipient_id:e,custom_profile_id:t,...s}){let i={event:{type:st.EDirectMessageEventTypeV1.Create,[st.EDirectMessageEventTypeV1.Create]:{target:{recipient_id:e},message_data:s}}};return t&&(i.event[st.EDirectMessageEventTypeV1.Create].custom_profile_id=t),this.post("direct_messages/events/new.json",i,{forceBodyMode:"json"})}getDmEvent(e){return this.get("direct_messages/events/show.json",{id:e})}deleteDm(e){return this.delete("direct_messages/events/destroy.json",{id:e})}async listDmEvents(e={}){let t={...e},s=await this.get("direct_messages/events/list.json",t,{fullResponse:!0});return new Bs.DmEventsV1Paginator({realData:s.data,rateLimit:s.rateLimit,instance:this,queryParams:t})}newWelcomeDm(e,t){let s={[st.EDirectMessageEventTypeV1.WelcomeCreate]:{name:e,message_data:t}};return this.post("direct_messages/welcome_messages/new.json",s,{forceBodyMode:"json"})}getWelcomeDm(e){return this.get("direct_messages/welcome_messages/show.json",{id:e})}deleteWelcomeDm(e){return this.delete("direct_messages/welcome_messages/destroy.json",{id:e})}updateWelcomeDm(e,t){let s={message_data:t};return this.put("direct_messages/welcome_messages/update.json",s,{forceBodyMode:"json",query:{id:e}})}async listWelcomeDms(e={}){let t={...e},s=await this.get("direct_messages/welcome_messages/list.json",t,{fullResponse:!0});return new Bs.WelcomeDmV1Paginator({realData:s.data,rateLimit:s.rateLimit,instance:this,queryParams:t})}newWelcomeDmRule(e){return this.post("direct_messages/welcome_messages/rules/new.json",{welcome_message_rule:{welcome_message_id:e}},{forceBodyMode:"json"})}getWelcomeDmRule(e){return this.get("direct_messages/welcome_messages/rules/show.json",{id:e})}deleteWelcomeDmRule(e){return this.delete("direct_messages/welcome_messages/rules/destroy.json",{id:e})}async listWelcomeDmRules(e={}){let t={...e};return this.get("direct_messages/welcome_messages/rules/list.json",t)}async setWelcomeDm(e,t=!0){var s;let i=await this.listWelcomeDmRules();if((s=i.welcome_message_rules)===null||s===void 0?void 0:s.length)for(let n of i.welcome_message_rules)await this.deleteWelcomeDmRule(n.id),t&&await this.deleteWelcomeDm(n.welcome_message_id);return this.newWelcomeDmRule(e)}markDmAsRead(e,t){return this.post("direct_messages/mark_read.json",{last_read_event_id:e,recipient_id:t},{forceBodyMode:"url"})}indicateDmTyping(e){return this.post("direct_messages/indicate_typing.json",{recipient_id:e},{forceBodyMode:"url"})}};te.TwitterApiv1=xt;te.default=xt});var Hs=u(M=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0});M.TweetV2UserLikedTweetsPaginator=M.TweetUserMentionTimelineV2Paginator=M.TweetUserTimelineV2Paginator=M.TweetSearchAllV2Paginator=M.TweetSearchRecentV2Paginator=void 0;var Jn=G(),Ft=class extends Jn.PreviousableTwitterPaginator{updateIncludes(e){if(!e.includes)return;this._realData.includes||(this._realData.includes={});let t=this._realData.includes;for(let[s,i]of Object.entries(e.includes))t[s]||(t[s]=[]),t[s]=[...t[s],...i]}getPageLengthFromRequest(e){var t,s;return(s=(t=e.data.data)===null||t===void 0?void 0:t.length)!==null&&s!==void 0?s:0}isFetchLastOver(e){var t;return!((t=e.data.data)===null||t===void 0?void 0:t.length)||!e.data.meta.next_token}getItemArray(){return this.tweets}get tweets(){var e;return(e=this._realData.data)!==null&&e!==void 0?e:[]}get meta(){return this._realData.meta}get includes(){var e;return(e=this._realData.includes)!==null&&e!==void 0?e:{}}},Ae=class extends Ft{refreshInstanceFromResult(e,t){var s;let i=e.data,n=(s=i.data)!==null&&s!==void 0?s:[];this._rateLimit=e.rateLimit,this._realData.data||(this._realData.data=[]),t?(this._realData.meta.oldest_id=i.meta.oldest_id,this._realData.meta.result_count+=i.meta.result_count,this._realData.meta.next_token=i.meta.next_token,this._realData.data.push(...n)):(this._realData.meta.newest_id=i.meta.newest_id,this._realData.meta.result_count+=i.meta.result_count,this._realData.data.unshift(...n)),this.updateIncludes(i)}getNextQueryParams(e){return{...this.injectQueryParams(e),until_id:this._realData.meta.oldest_id}}getPreviousQueryParams(e){return{...this.injectQueryParams(e),since_id:this._realData.meta.newest_id}}},Ns=class extends Ae{constructor(){super(...arguments);this._endpoint="tweets/search/recent"}};M.TweetSearchRecentV2Paginator=Ns;var Vs=class extends Ae{constructor(){super(...arguments);this._endpoint="tweets/search/all"}};M.TweetSearchAllV2Paginator=Vs;var Ws=class extends Ae{constructor(){super(...arguments);this._endpoint="users/:id/tweets"}};M.TweetUserTimelineV2Paginator=Ws;var Es=class extends Ae{constructor(){super(...arguments);this._endpoint="users/:id/mentions"}};M.TweetUserMentionTimelineV2Paginator=Es;var $s=class extends Ft{refreshInstanceFromResult(e,t){var s;let i=e.data,n=(s=i.data)!==null&&s!==void 0?s:[];this._rateLimit=e.rateLimit,this._realData.data||(this._realData.data=[]),t?(this._realData.meta.result_count+=i.meta.result_count,this._realData.meta.next_token=i.meta.next_token,this._realData.data.push(...n)):(this._realData.meta.result_count+=i.meta.result_count,this._realData.meta.previous_token=i.meta.previous_token,this._realData.data.unshift(...n)),this.updateIncludes(i)}getNextQueryParams(e){return{...this.injectQueryParams(e),pagination_token:this._realData.meta.next_token}}getPreviousQueryParams(e){return{...this.injectQueryParams(e),pagination_token:this._realData.meta.previous_token}}},Cs=class extends $s{constructor(){super(...arguments);this._endpoint="users/:id/liked_tweets"}};M.TweetV2UserLikedTweetsPaginator=Cs});var Ut=u(N=>{"use strict";Object.defineProperty(N,"__esModule",{value:!0});N.UserFollowingV2Paginator=N.UserFollowersV2Paginator=N.UserMutingUsersV2Paginator=N.UserBlockingUsersV2Paginator=void 0;var Gn=G(),Oe=class extends Gn.PreviousableTwitterPaginator{refreshInstanceFromResult(e,t){var s;let i=e.data,n=(s=i.data)!==null&&s!==void 0?s:[];this._rateLimit=e.rateLimit,this._realData.data||(this._realData.data=[]),t?(this._realData.meta.result_count+=i.meta.result_count,this._realData.meta.next_token=i.meta.next_token,this._realData.data.push(...n)):(this._realData.meta.result_count+=i.meta.result_count,this._realData.meta.previous_token=i.meta.previous_token,this._realData.data.unshift(...n)),this.updateIncludes(i)}updateIncludes(e){if(!e.includes)return;this._realData.includes||(this._realData.includes={});let t=this._realData.includes;for(let[s,i]of Object.entries(e.includes))t[s]||(t[s]=[]),t[s]=[...t[s],...i]}getNextQueryParams(e){return{...this.injectQueryParams(e),pagination_token:this._realData.meta.next_token}}getPreviousQueryParams(e){return{...this.injectQueryParams(e),pagination_token:this._realData.meta.previous_token}}getPageLengthFromRequest(e){var t,s;return(s=(t=e.data.data)===null||t===void 0?void 0:t.length)!==null&&s!==void 0?s:0}isFetchLastOver(e){var t;return!((t=e.data.data)===null||t===void 0?void 0:t.length)||!e.data.meta.next_token}getItemArray(){return this.users}get users(){var e;return(e=this._realData.data)!==null&&e!==void 0?e:[]}get meta(){return this._realData.meta}get includes(){var e;return(e=this._realData.includes)!==null&&e!==void 0?e:{}}},Ks=class extends Oe{constructor(){super(...arguments);this._endpoint="users/:id/blocking"}};N.UserBlockingUsersV2Paginator=Ks;var Qs=class extends Oe{constructor(){super(...arguments);this._endpoint="users/:id/muting"}};N.UserMutingUsersV2Paginator=Qs;var zs=class extends Oe{constructor(){super(...arguments);this._endpoint="users/:id/followers"}};N.UserFollowersV2Paginator=zs;var Xs=class extends Oe{constructor(){super(...arguments);this._endpoint="users/:id/following"}};N.UserFollowingV2Paginator=Xs});var kt=u(P=>{"use strict";var Zn=P&&P.__createBinding||(Object.create?function(r,e,t,s){s===void 0&&(s=t),Object.defineProperty(r,s,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,s){s===void 0&&(s=t),r[s]=e[t]}),X=P&&P.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Zn(e,r,t)};Object.defineProperty(P,"__esModule",{value:!0});X(Hs(),P);X(G(),P);X(dt(),P);X(Rt(),P);X(bt(),P);X(Dt(),P);X(Ut(),P);X(Lt(),P)});var Bt=u(xe=>{"use strict";var ea=xe&&xe.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(xe,"__esModule",{value:!0});var ta=ea(Ge()),ra=U(),Ys=class extends ta.default{constructor(){super(...arguments);this._prefix=ra.API_V2_LABS_PREFIX}};xe.default=Ys});var Nt=u(Ue=>{"use strict";var Js=Ue&&Ue.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Ue,"__esModule",{value:!0});var sa=Js(Ge()),ia=U(),Fe=kt(),na=Js(Bt()),it=Ut(),Gs=de(),Zs=class extends sa.default{constructor(){super(...arguments);this._prefix=ia.API_V2_PREFIX}get labs(){return this._labs?this._labs:this._labs=new na.default(this)}async search(e,t={}){let s={...t,query:e},i=await this.get("tweets/search/recent",s,{fullResponse:!0});return new Fe.TweetSearchRecentV2Paginator({realData:i.data,rateLimit:i.rateLimit,instance:this,queryParams:s})}async searchAll(e,t={}){let s={...t,query:e},i=await this.get("tweets/search/all",s,{fullResponse:!0});return new Fe.TweetSearchAllV2Paginator({realData:i.data,rateLimit:i.rateLimit,instance:this,queryParams:s})}singleTweet(e,t={}){return this.get("tweets/:id",t,{params:{id:e}})}tweets(e,t={}){return this.get("tweets",{ids:e,...t})}tweetCountRecent(e,t={}){return this.get("tweets/counts/recent",{query:e,...t})}tweetCountAll(e,t={}){return this.get("tweets/counts/all",{query:e,...t})}tweetRetweetedBy(e,t={}){return this.get("tweets/:id/retweeted_by",t,{params:{id:e}})}tweetLikedBy(e,t={}){return this.get("tweets/:id/liking_users",t,{params:{id:e}})}async userTimeline(e,t={}){let s=await this.get("users/:id/tweets",t,{fullResponse:!0,params:{id:e}});return new Fe.TweetUserTimelineV2Paginator({realData:s.data,rateLimit:s.rateLimit,instance:this,queryParams:t,sharedParams:{id:e}})}async userMentionTimeline(e,t={}){let s=await this.get("users/:id/mentions",t,{fullResponse:!0,params:{id:e}});return new Fe.TweetUserMentionTimelineV2Paginator({realData:s.data,rateLimit:s.rateLimit,instance:this,queryParams:t,sharedParams:{id:e}})}user(e,t={}){return this.get("users/:id",t,{params:{id:e}})}users(e,t={}){let s=Array.isArray(e)?e.join(","):e;return this.get("users",{...t,ids:s})}userByUsername(e,t={}){return this.get("users/by/username/:username",t,{params:{username:e}})}usersByUsernames(e,t={}){return e=Array.isArray(e)?e.join(","):e,this.get("users/by",{...t,usernames:e})}async followers(e,t={}){let{asPaginator:s,...i}=t,n={id:e};if(!s)return this.get("users/:id/followers",i,{params:n});let a=await this.get("users/:id/followers",i,{fullResponse:!0,params:n});return new it.UserFollowersV2Paginator({realData:a.data,rateLimit:a.rateLimit,instance:this,queryParams:i,sharedParams:n})}async following(e,t={}){let{asPaginator:s,...i}=t,n={id:e};if(!s)return this.get("users/:id/following",i,{params:n});let a=await this.get("users/:id/following",i,{fullResponse:!0,params:n});return new it.UserFollowingV2Paginator({realData:a.data,rateLimit:a.rateLimit,instance:this,queryParams:i,sharedParams:n})}async userLikedTweets(e,t={}){let s={id:e},i=await this.get("users/:id/liked_tweets",t,{fullResponse:!0,params:s});return new Fe.TweetV2UserLikedTweetsPaginator({realData:i.data,rateLimit:i.rateLimit,instance:this,queryParams:{...t},sharedParams:s})}async userBlockingUsers(e,t={}){let s={id:e},i=await this.get("users/:id/blocking",t,{fullResponse:!0,params:s});return new it.UserBlockingUsersV2Paginator({realData:i.data,rateLimit:i.rateLimit,instance:this,queryParams:{...t},sharedParams:s})}async userMutingUsers(e={}){let{id_str:t}=await this.getCurrentUserObject(),s={id:t},i=await this.get("users/:id/muting",e,{fullResponse:!0,params:s});return new it.UserMutingUsersV2Paginator({realData:i.data,rateLimit:i.rateLimit,instance:this,queryParams:{...e},sharedParams:s})}space(e,t={}){return this.get("spaces/:id",t,{params:{id:e}})}spaces(e,t={}){return this.get("spaces",{ids:e,...t})}spacesByCreators(e,t={}){return this.get("spaces/by/creator_ids",{user_ids:e,...t})}searchSpaces(e){return this.get("spaces/search",e)}searchStream({autoConnect:e,...t}={}){return this.getStream("tweets/search/stream",t,{payloadIsError:Gs.isTweetStreamV2ErrorPayload,autoConnect:e})}streamRules(e={}){return this.get("tweets/search/stream/rules",e)}updateStreamRules(e,t={}){return this.post("tweets/search/stream/rules",e,{query:t})}sampleStream({autoConnect:e,...t}={}){return this.getStream("tweets/sample/stream",t,{payloadIsError:Gs.isTweetStreamV2ErrorPayload,autoConnect:e})}complianceJobs(e){return this.get("compliance/jobs",e)}complianceJob(e){return this.get("compliance/jobs/:id",void 0,{params:{id:e}})}async sendComplianceJob(e){let t=await this.post("compliance/jobs",{type:e.type,name:e.name}),s=e.ids instanceof Buffer?e.ids:Buffer.from(e.ids.join(`
`));return await this.put(t.data.upload_url,s,{forceBodyMode:"raw",enableAuth:!1,headers:{"Content-Type":"text/plain"},prefix:""}),t}async complianceJobResult(e){let t=e;for(;t.status!=="complete";){if(t.status==="expired"||t.status==="failed")throw new Error("Job failed to be completed.");await new Promise(i=>setTimeout(i,3500)),t=(await this.complianceJob(e.id)).data}return(await this.get(e.download_url,void 0,{enableAuth:!1,prefix:""})).trim().split(`
`).filter(i=>i).map(i=>JSON.parse(i))}};Ue.default=Zs});var Vt=u(ke=>{"use strict";var aa=ke&&ke.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(ke,"__esModule",{value:!0});var oa=U(),ua=aa(Bt()),ei=class extends ua.default{constructor(){super(...arguments);this._prefix=oa.API_V2_LABS_PREFIX}get readOnly(){return this}};ke.default=ei});var Wt=u(Be=>{"use strict";var ti=Be&&Be.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Be,"__esModule",{value:!0});var ca=U(),la=ti(Nt()),da=ti(Vt()),ri=class extends la.default{constructor(){super(...arguments);this._prefix=ca.API_V2_PREFIX}get readOnly(){return this}get labs(){return this._labs?this._labs:this._labs=new da.default(this)}hideReply(e,t){return this.put("tweets/:id/hidden",{hidden:t},{params:{id:e}})}like(e,t){return this.post("users/:id/likes",{tweet_id:t},{params:{id:e}})}unlike(e,t){return this.delete("users/:id/likes/:tweet_id",void 0,{params:{id:e,tweet_id:t}})}retweet(e,t){return this.post("users/:id/retweets",{tweet_id:t},{params:{id:e}})}unretweet(e,t){return this.delete("users/:id/retweets/:tweet_id",void 0,{params:{id:e,tweet_id:t}})}follow(e,t){return this.post("users/:id/following",{target_user_id:t},{params:{id:e}})}unfollow(e,t){return this.delete("users/:source_user_id/following/:target_user_id",void 0,{params:{source_user_id:e,target_user_id:t}})}block(e,t){return this.post("users/:id/blocking",{target_user_id:t},{params:{id:e}})}unblock(e,t){return this.delete("users/:source_user_id/blocking/:target_user_id",void 0,{params:{source_user_id:e,target_user_id:t}})}mute(e,t){return this.post("users/:id/muting",{target_user_id:t},{params:{id:e}})}unmute(e,t){return this.delete("users/:source_user_id/muting/:target_user_id",void 0,{params:{source_user_id:e,target_user_id:t}})}createList(e){return this.post("lists",e)}updateList(e,t={}){return this.put("lists/:id",t,{params:{id:e}})}removeList(e){return this.delete("lists/:id",void 0,{params:{id:e}})}addListMember(e,t){return this.post("lists/:id/members",{user_id:t},{params:{id:e}})}removeListMember(e,t){return this.delete("lists/:id/members/:user_id",void 0,{params:{id:e,user_id:t}})}subscribeToList(e,t){return this.post("users/:id/followed_lists",{list_id:t},{params:{id:e}})}unsubscribeOfList(e,t){return this.delete("users/:id/followed_lists/:list_id",void 0,{params:{id:e,list_id:t}})}pinList(e,t){return this.post("users/:id/pinned_lists",{list_id:t},{params:{id:e}})}unpinList(e,t){return this.delete("users/:id/pinned_lists/:list_id",void 0,{params:{id:e,list_id:t}})}};Be.default=ri});var $t=u(re=>{"use strict";var ha=re&&re.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(re,"__esModule",{value:!0});re.TwitterApiv2Labs=void 0;var ma=U(),fa=ha(Vt()),Et=class extends fa.default{constructor(){super(...arguments);this._prefix=ma.API_V2_LABS_PREFIX}get readWrite(){return this}};re.TwitterApiv2Labs=Et;re.default=Et});var Ht=u(se=>{"use strict";var si=se&&se.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(se,"__esModule",{value:!0});se.TwitterApiv2=void 0;var _a=U(),pa=si(Wt()),ga=si($t()),Ct=class extends pa.default{constructor(){super(...arguments);this._prefix=_a.API_V2_PREFIX}get readWrite(){return this}get labs(){return this._labs?this._labs:this._labs=new ga.default(this)}};se.TwitterApiv2=Ct;se.default=Ct});var ni=u(V=>{"use strict";var wa=V&&V.__createBinding||(Object.create?function(r,e,t,s){s===void 0&&(s=t),Object.defineProperty(r,s,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,s){s===void 0&&(s=t),r[s]=e[t]}),ya=V&&V.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),va=V&&V.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&wa(e,r,t);return ya(e,r),e};Object.defineProperty(V,"__esModule",{value:!0});V.OAuth2Helper=void 0;var Pa=va(require("crypto")),ii=class{static getCodeVerifier(){return this.generateRandomString(128)}static getCodeChallengeFromVerifier(e){return this.escapeBase64Url(Pa.createHash("sha256").update(e).digest("base64"))}static generateRandomString(e){let t="",s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~";for(let i=0;i<e;i++)t+=s[Math.floor(Math.random()*s.length)];return t}static escapeBase64Url(e){return e.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}};V.OAuth2Helper=ii});var Qt=u(Ne=>{"use strict";var nt=Ne&&Ne.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Ne,"__esModule",{value:!0});var at=nt(ot()),Ta=nt(Tt()),ba=nt(Mt()),Ra=nt(Nt()),Kt=ni(),ai=class extends Ta.default{get v1(){return this._v1?this._v1:this._v1=new ba.default(this)}get v2(){return this._v2?this._v2:this._v2=new Ra.default(this)}async currentUser(e=!1){return await this.getCurrentUserObject(e)}search(e,t){return this.v2.search(e,t)}async generateAuthLink(e="oob",{authAccessType:t,linkMode:s="authenticate",forceLogin:i,screenName:n}={}){let a=await this.post("https://api.twitter.com/oauth/request_token",{oauth_callback:e,x_auth_access_type:t}),o=`https://api.twitter.com/oauth/${s}?oauth_token=${encodeURIComponent(a.oauth_token)}`;return i!==void 0&&(o+=`&force_login=${encodeURIComponent(i)}`),n!==void 0&&(o+=`&screen_name=${encodeURIComponent(n)}`),{url:o,...a}}async login(e){let t=await this.post("https://api.twitter.com/oauth/access_token",{oauth_token:this._accessToken,oauth_verifier:e}),s=new at.default({appKey:this._consumerToken,appSecret:this._consumerSecret,accessToken:t.oauth_token,accessSecret:t.oauth_token_secret});return{accessToken:t.oauth_token,accessSecret:t.oauth_token_secret,userId:t.user_id,screenName:t.screen_name,client:s}}async appLogin(){if(!this._consumerToken||!this._consumerSecret)throw new Error("You must setup TwitterApi instance with consumers to enable app-only login");let t=await new at.default({username:this._consumerToken,password:this._consumerSecret}).post("https://api.twitter.com/oauth2/token",{grant_type:"client_credentials"});return new at.default(t.access_token)}generateOAuth2AuthLink(e,t={}){var s,i;if(!this._clientId)throw new Error("Twitter API instance is not initialized with client ID. Please build an instance with: new TwitterApi({ clientId: '<yourClientId>' })");let n=(s=t.state)!==null&&s!==void 0?s:Kt.OAuth2Helper.generateRandomString(32),a=Kt.OAuth2Helper.getCodeVerifier(),o=Kt.OAuth2Helper.getCodeChallengeFromVerifier(a),l=(i=t.scope)!==null&&i!==void 0?i:"",h=Array.isArray(l)?l.join(" "):l,d=new URL("https://twitter.com/i/oauth2/authorize");return d.searchParams.set("response_type","code"),d.searchParams.set("client_id",this._clientId),d.searchParams.set("redirect_uri",e),d.searchParams.set("state",n),d.searchParams.set("code_challenge",o),d.searchParams.set("code_challenge_method","s256"),d.searchParams.set("scope",h),{url:d.toString(),state:n,codeVerifier:a,codeChallenge:o}}async loginWithOAuth2({code:e,codeVerifier:t,redirectUri:s}){if(!this._clientId)throw new Error("Twitter API instance is not initialized with client ID. Please build an instance with: new TwitterApi({ clientId: '<yourClientId>' })");let i=await this.post("https://api.twitter.com/2/oauth2/token",{code:e,code_verifier:t,redirect_uri:s,grant_type:"authorization_code",client_id:this._clientId});return this.parseOAuth2AccessTokenResult(i)}async refreshOAuth2Token(e){if(!this._clientId)throw new Error("Twitter API instance is not initialized with client ID. Please build an instance with: new TwitterApi({ clientId: '<yourClientId>' })");let t=await this.post("https://api.twitter.com/2/oauth2/token",{refresh_token:e,grant_type:"refresh_token",client_id:this._clientId});return this.parseOAuth2AccessTokenResult(t)}async revokeOAuth2Token(e,t="access_token"){if(!this._clientId)throw new Error("Twitter API instance is not initialized with client ID. Please build an instance with: new TwitterApi({ clientId: '<yourClientId>' })");return await this.post("https://api.twitter.com/2/oauth2/revoke",{client_id:this._clientId,token:e,token_type_hint:t})}parseOAuth2AccessTokenResult(e){let t=new at.default(e.access_token),s=e.scope.split(" ").filter(i=>i);return{client:t,expiresIn:e.expires_in,accessToken:e.access_token,scope:s,refreshToken:e.refresh_token}}};Ne.default=ai});var Xt=u(Ve=>{"use strict";var zt=Ve&&Ve.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Ve,"__esModule",{value:!0});var Sa=zt(Ot()),Da=zt(Wt()),qa=zt(Qt()),oi=class extends qa.default{get v1(){return this._v1?this._v1:this._v1=new Sa.default(this)}get v2(){return this._v2?this._v2:this._v2=new Da.default(this)}get readOnly(){return this}};Ve.default=oi});var ot=u(F=>{"use strict";var We=F&&F.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(F,"__esModule",{value:!0});F.TwitterApiReadOnly=F.TwitterApiReadWrite=F.TwitterApi=void 0;var La=We(et()),ja=We(Ht()),Ia=We(Xt()),Yt=class extends Ia.default{get v1(){return this._v1?this._v1:this._v1=new La.default(this)}get v2(){return this._v2?this._v2:this._v2=new ja.default(this)}get readWrite(){return this}static getErrors(e){var t;return typeof e!="object"?[]:"data"in e?(t=e.data.errors)!==null&&t!==void 0?t:[]:[]}static getProfileImageInSize(e,t){let s=e.split("/").pop(),i=["normal","bigger","mini"],n=e;for(let o of i)if(s.includes(`_${o}`)){n=e.replace(`_${o}`,"");break}if(t==="original")return n;let a=n.lastIndexOf(".");if(a!==-1){let o=n.slice(a+1);return n.slice(0,a)+"_"+t+"."+o}else return n+"_"+t}};F.TwitterApi=Yt;var Ma=Xt();Object.defineProperty(F,"TwitterApiReadWrite",{enumerable:!0,get:function(){return We(Ma).default}});var Aa=Qt();Object.defineProperty(F,"TwitterApiReadOnly",{enumerable:!0,get:function(){return We(Aa).default}});F.default=Yt});var ui=u(p=>{"use strict";var Oa=p&&p.__createBinding||(Object.create?function(r,e,t,s){s===void 0&&(s=t),Object.defineProperty(r,s,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,s){s===void 0&&(s=t),r[s]=e[t]}),Y=p&&p.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Oa(e,r,t)},xa=p&&p.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(p,"__esModule",{value:!0});p.default=void 0;var Fa=ot();Object.defineProperty(p,"default",{enumerable:!0,get:function(){return xa(Fa).default}});Y(ot(),p);Y(et(),p);Y(Ht(),p);Y($t(),p);Y(ce(),p);Y(kt(),p);Y(Qe(),p);Y(Ke(),p)});var Na={};Oi(Na,{default:()=>bi});var ge=require("@raycast/api"),Ti=require("react");var pe=require("@raycast/api");function Q(r){return r instanceof Error?r.message:"unknown error"}var lr=(r,e)=>String(r).padStart(e,"\u2000"),Ui=new Intl.NumberFormat("en",{notation:"compact"});function ye(r){return Ui.format(r)}var yi=require("@raycast/api");var ct=require("@raycast/api");var m=require("@raycast/api");var ci=require("@raycast/api"),ie=require("react"),li=xi(ui());function Ua(){let r=(0,ci.getPreferenceValues)(),e=r.appkey||"",t=r.appsecret||"",s=r.accesstoken||"",i=r.accesssecret||"";return new li.TwitterApi({appKey:e,appSecret:t,accessToken:s,accessSecret:i})}var R=Ua(),Jt;async function Gt(){return Jt||(Jt=await R.v1.accountSettings()),Jt}async function Zt(r){if(r){let e=r.map(i=>i.id_str),t=await R.v1.tweets(e),s=[];for(let i of e){let n=t.find(a=>i===a.id_str);n&&s.push(n)}return s}else return}async function di(r){let e=await Zt([r]);if(e&&e.length===1)return e[0]}function _e(r,e){let[t,s]=(0,ie.useState)(),[i,n]=(0,ie.useState)(),[a,o]=(0,ie.useState)(!0),[l,h]=(0,ie.useState)(new Date),d=[l];if(e)for(let W of e)d.push(W);let v=!1,T={updateInline:async()=>{await H(!0)},refresh:async()=>{h(new Date)}};async function H(W=!1){if(!v){o(!0),n(void 0);try{let we=await r(W);v||s(we)}catch(we){v||n(Q(we))}finally{v||o(!1)}}}return(0,ie.useEffect)(()=>(H(),()=>{v=!0}),d),{data:t,error:i,isLoading:a,fetcher:T}}function er(r){let e=r.entities.media;if(e){for(let t of e)if(t.type==="photo"&&t.media_url_https)return t.media_url_https}}var c=require("@raycast/api"),ut=require("react");var g=require("@raycast/api");async function hi(r,e){try{let t=r.text;if(t.length<0)throw Error("Please enter a text");if(t.length>280)throw Error("Tweet text could not be longer than 280 characters");e?(await R.v1.reply(t,e.id_str),await(0,g.showToast)(g.ToastStyle.Success,"Tweet created","Reply Tweet creation successful")):(await R.v1.tweet(t),await(0,g.showToast)(g.ToastStyle.Success,"Tweet created","Tweet creation successful")),(0,g.popToRoot)()}catch(t){await(0,g.showToast)(g.ToastStyle.Failure,"Error",Q(t))}}function mi(r){let e=r.replyTweet;return _jsx(g.Form,{onSubmit:hi,actions:_jsx(g.ActionPanel,null,_jsx(g.SubmitFormAction,{title:e?"Send Reply":"Send Tweet",onSubmit:i=>hi(i,e)}))},_jsx(g.FormTextArea,{id:"text",title:e?"Reply":"Tweet",placeholder:"What's happening?"}))}function fi(r){return _jsx(c.PushAction,{title:"Show Tweet",target:_jsx(pi,{tweet:r.tweet}),icon:{source:c.Icon.List,tintColor:c.Color.PrimaryText}})}function tr(r){return _jsx(c.PushAction,{title:"Reply",target:_jsx(mi,{replyTweet:r.tweet}),icon:{source:c.Icon.Bubble,tintColor:c.Color.PrimaryText},shortcut:{modifiers:["cmd"],key:"w"}})}function rr(r){let[e,t]=(0,ut.useState)();(0,ut.useEffect)(()=>{async function n(){try{let a=await Gt();t(a.screen_name)}catch{}}n()},[]);let s=r.tweet,i=async()=>{try{if((await Gt()).screen_name!==s.user.screen_name)throw Error("You can only delete your own Tweets");await R.v1.deleteTweet(s.id_str),(0,c.showToast)(c.ToastStyle.Success,"Tweet deleted","Tweet deletion successful")}catch(n){(0,c.showToast)(c.ToastStyle.Failure,"Could not delete Tweet",Q(n))}};return e===s.user.screen_name?_jsx(c.ActionPanel.Item,{title:"Delete Tweet",icon:{source:c.Icon.XmarkCircle,tintColor:c.Color.Red},onAction:i}):null}function sr(r){let e=r.tweet,t=e.retweeted?"unretweet":"retweet",s=e.retweeted?"Unretweet":"Retweet",i=e.retweeted?{source:"retweet.png",tintColor:c.Color.Green}:{source:"retweet.png",tintColor:c.Color.PrimaryText},n=async()=>{try{await R.v1.post(`statuses/${t}/${e.id_str}.json`),(0,c.showToast)(c.ToastStyle.Success,"Retweet successful","Retweet creation successful"),r.fetcher&&await r.fetcher.updateInline()}catch(a){(0,c.showToast)(c.ToastStyle.Failure,"Could not retweet",Q(a))}};return _jsx(c.ActionPanel.Item,{title:s,icon:i,onAction:n,shortcut:{modifiers:["cmd"],key:"t"}})}function ir(r){let e=r.tweet,t=e.favorited?"destroy":"create",s=e.favorited?"Undo Like":"Like",i=e.favorited?{source:"heart_full.png",tintColor:c.Color.Red}:{source:"heart_empty.png",tintColor:c.Color.PrimaryText},n=async()=>{try{await R.v1.post(`favorites/${t}.json`,{id:e.id_str}),(0,c.showToast)(c.ToastStyle.Success,`${s} successful`,`${s} operation successful`),r.fetcher&&await r.fetcher.updateInline()}catch(a){(0,c.showToast)(c.ToastStyle.Failure,`${s} failed`,Q(a))}};return _jsx(c.ActionPanel.Item,{title:s,shortcut:{modifiers:["cmd"],key:"l"},icon:i,onAction:n})}function nr(r){return _jsx(c.OpenInBrowserAction,{title:"Open Author Profile",url:`https://twitter.com/${r.tweet.user.screen_name}`,icon:{source:c.Icon.Person,tintColor:c.Color.PrimaryText}})}function _i(r){let e=async()=>{r.fetcher&&await r.fetcher.updateInline()};return _jsx(c.ActionPanel.Item,{title:"Refresh Existing Tweets",shortcut:{modifiers:["cmd","shift"],key:"r"},icon:{source:c.Icon.Download,tintColor:c.Color.PrimaryText},onAction:e})}function ar(r){let e=async()=>{r.fetcher&&await r.fetcher.refresh()},t=r.title?r.title:"Refresh Tweets";return _jsx(c.ActionPanel.Item,{title:t,shortcut:{modifiers:["cmd"],key:"r"},icon:{source:c.Icon.Binoculars,tintColor:c.Color.PrimaryText},onAction:e})}function or(r){return _jsx(c.PushAction,{title:r.title||`Tweets from @${r.username}`,shortcut:{modifiers:["cmd","shift"],key:"a"},icon:{source:"twitter.png",tintColor:c.Color.PrimaryText},target:_jsx(Ee,{username:r.username})})}function gi(r){return`https://twitter.com/${r.user.screen_name}/status/${r.id_str}`}function ka(r){let e=r.tweet,t=r.fetcher,s=r.millifyState!==void 0?r.millifyState:!0,i=70,n=e.full_text?e.full_text.trim():"",a=n.slice(0,i)+(n.length>i?" ...":""),l=e.user.profile_image_url_https?{source:e.user.profile_image_url_https,mask:m.ImageMask.Circle}:void 0,h=e.favorited&&n.startsWith("RT @")?1:0,d=!!er(e),v=(K,Di)=>{if(K===void 0)return"0";let qi=s?ye(K):`${K}`;return lr(qi,Di)},T=1,H=3,W=K=>K===void 0||K<T?T:K>H?H:K,we=W(r.maxCommentDigits),Ri=W(r.maxRTDigits),Si=W(r.maxFavDigits),lt=[`\u{1F4AC} ${v(e.reply_count||0,we)}`,`\u{1F501} ${v(e.retweet_count,Ri)}`,`\u2764\uFE0F ${v(e.favorite_count+h,Si)}`];return d&&(lt=["\u{1F5BC}\uFE0F",...lt]),_jsx(m.List.Item,{id:e.id_str,key:e.id_str,title:a,icon:l,accessoryTitle:lt.join("  "),actions:_jsx(m.ActionPanel,null,_jsx(m.ActionPanel.Section,{title:"Tweet"},_jsx(fi,{tweet:e}),_jsx(m.OpenInBrowserAction,{url:gi(e),shortcut:{modifiers:["cmd"],key:"b"}}),_jsx(ir,{tweet:e,fetcher:t}),_jsx(tr,{tweet:e}),_jsx(sr,{tweet:e,fetcher:t}),_jsx(or,{username:e.user.screen_name})),_jsx(m.ActionPanel.Section,{title:"Info"},_jsx(nr,{tweet:e})),_jsx(m.ActionPanel.Section,{title:"Destructive"},_jsx(rr,{tweet:e})),_jsx(m.ActionPanel.Section,{title:"Update"},_jsx(_i,{fetcher:t}),_jsx(ar,{fetcher:t})))})}function pi(r){let{data:e,error:t,isLoading:s,fetcher:i}=_e(async()=>e===void 0?r.tweet:await di(e));t&&(0,m.showToast)(m.ToastStyle.Failure,"Error",t);let n=e||r.tweet,a=n.favorited&&n.full_text&&n.full_text.startsWith("RT @")?1:0,o=[`\u{1F4AC} ${n.reply_count||0}`,`\u{1F501} ${n.retweet_count}`,`\u2764\uFE0F ${n.favorite_count+a}`],l=er(n),h=[`## ${n.user.name} \`@${n.user.screen_name}\``,n.full_text||"",`\`${n.created_at}\``];l&&h.push(`![${l}](${l})`),h.push(o.join("   "));let d=h.join(`

`);return _jsx(m.Detail,{isLoading:s,markdown:d,actions:_jsx(m.ActionPanel,null,_jsx(m.ActionPanel.Section,{title:"Tweet"},_jsx(tr,{tweet:n}),_jsx(ir,{tweet:n,fetcher:i}),_jsx(sr,{tweet:n,fetcher:i}),_jsx(or,{username:n.user.screen_name}),_jsx(m.OpenInBrowserAction,{url:gi(n),shortcut:{modifiers:["cmd"],key:"b"}})),_jsx(m.ActionPanel.Section,{title:"Info"},_jsx(nr,{tweet:n})),_jsx(m.ActionPanel.Section,{title:"Destructive"},_jsx(rr,{tweet:n})),_jsx(m.ActionPanel.Section,{title:"Update"},_jsx(ar,{title:"Refresh Tweet",fetcher:i})))})}function wi(r){let e=r.tweets,t=r.millifyState!==void 0?r.millifyState:!0,s=1,i=1,n=1,a=o=>o===void 0?0:(t?ye(o):`${o}`).length;if(e)for(let o of e){let l=a(o.favorite_count);l>s&&(s=l);let h=a(o.retweet_count);h>i&&(i=h);let d=a(o.reply_count);d>n&&(n=d)}return _jsx(m.List,{isLoading:r.isLoading,searchBarPlaceholder:"Filter Tweets by name..."},e?.map(o=>_jsx(ka,{key:o.id_str,tweet:o,fetcher:r.fetcher,maxCommentDigits:n,maxFavDigits:s,maxRTDigits:i,millifyState:t})))}function Ee(r){let e=r.username,{data:t,error:s,isLoading:i,fetcher:n}=_e(async a=>a?await Zt(t):await Ba(e));return s&&(0,ct.showToast)(ct.ToastStyle.Failure,"Error",s),_jsx(wi,{isLoading:i,tweets:t,fetcher:n})}async function Ba(r){let e=await R.v1.userTimelineByUsername(r),t=[];for(let s of e.tweets)t.push(s);return t}function vi(r){return _jsx(yi.PushAction,{title:"Show Tweets",target:_jsx(Ee,{username:r.user.screen_name}),icon:{source:"twitter.png"}})}function Pi(r){let e=r.user;return _jsx(pe.List.Item,{key:e.screen_name,title:e.name,subtitle:`@${e.screen_name}`,icon:{source:e.profile_image_url_https,mask:pe.ImageMask.Circle},accessoryTitle:`${ye(e.followers_count)}`,accessoryIcon:{source:"\u{1F440}"},actions:_jsx(pe.ActionPanel,null,_jsx(vi,{user:e}))})}function bi(){let[r,e]=(0,Ti.useState)(),{data:t,error:s,isLoading:i,fetcher:n}=_e(async()=>{if(r&&r.length>0&&r!=="@"){let a=await R.v1.searchUsers(r),o=[];for(let l of a)o.push(l);return o}else return},[r]);return s&&(0,ge.showToast)(ge.ToastStyle.Failure,"Error",s),_jsx(ge.List,{isLoading:i,searchBarPlaceholder:"Search User by name of handle (e.g. @tonka_2000 or Michael Aigner)...",onSearchTextChange:e,throttle:!0},t?.map(a=>_jsx(Pi,{key:a.screen_name,user:a})))}module.exports=Fi(Na);0&&(module.exports={});
